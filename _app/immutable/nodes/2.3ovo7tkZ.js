import{a as Ne,Z as Ct,_ as xt,a1 as Ot,a2 as dn,V as Kl,W as Ql,X as Jl,Y as en,T as we,U as $e,d as B,g as $,p as _,j as W,n as qe,m as be,A as dt,D as st,B as Ue,e as M,c as L,q as De,w as lt,b as G,h as R,k as I,o as ye,ae as re,G as tn,ad as ln,v as _e,r as Pe,a7 as _t,u as ne,$ as bt,t as pe,f as ge,l as Se,a5 as pn,af as gn}from"../chunks/scheduler.CknTtfwd.js";import{S as Me,i as Le,c as ue,a as fe,m as he,t as X,b as te,d as de,g as Be,e as ze,h as mn}from"../chunks/index.Cb0qHW9x.js";import{r as rt,a as it,t as Ze,m as kt,e as ce,l as Qe,n as Re,o as ht,q as nn,v as Vt,p as wt,s as ut,b as ct,h as gt,u as vn,d as St,Z as _n,f as jt,M as bn,w as sn,P as kn,i as wn,x as $n,y as yn,z as En}from"../chunks/index.SZUUYpd_.js";import{d as oe,a as In,f as Dn,e as Cn}from"../chunks/PositionalEncodingPopover.svelte_svelte_type_style_lang.DKq7mr22.js";import{s as Gt,a as Je,M as at,F as tt}from"../chunks/WeightPopover.svelte_svelte_type_style_lang.B-4ULxpN.js";import{A as on}from"../chunks/image.hCAKpID9.js";import{c as Vn,a as Sn,b as qn,t as An,g as ot,P as qt}from"../chunks/index.BH8hwKuQ.js";import{l as Nn}from"../chunks/linear.CXGWFpQF.js";import{b as Mn}from"../chunks/paths.Uf2JShBi.js";function Ln(n){let e;const t=n[4].default,l=Kl(t,n,n[6],null);return{c(){l&&l.c()},l(s){l&&l.l(s)},m(s,o){l&&l.m(s,o),e=!0},p(s,o){l&&l.p&&(!e||o&64)&&Ql(l,t,s,s[6],e?en(t,s[6],o,null):Jl(s[6]),null)},i(s){e||(X(l,s),e=!0)},o(s){te(l,s),e=!1},d(s){l&&l.d(s)}}}function Bn(n){let e,t;const l=[{rounded:!0},{shadow:!0},n[1],{class:n[0]}];let s={$$slots:{default:[Ln]},$$scope:{ctx:n}};for(let o=0;o<l.length;o+=1)s=Ct(s,l[o]);return e=new Vn({props:s}),e.$on("show",n[5]),{c(){ue(e.$$.fragment)},l(o){fe(e.$$.fragment,o)},m(o,r){he(e,o,r),t=!0},p(o,[r]){const h=r&3?Sn(l,[l[0],l[1],r&2&&qn(o[1]),r&1&&{class:o[0]}]):{};r&64&&(h.$$scope={dirty:r,ctx:o}),e.$set(h)},i(o){t||(X(e.$$.fragment,o),t=!0)},o(o){te(e.$$.fragment,o),t=!1},d(o){de(e,o)}}}function zn(n,e,t){const l=["type","defaultClass"];let s=xt(e,l),{$$slots:o={},$$scope:r}=e,{type:h="dark"}=e,{defaultClass:i="py-2 px-3 text-sm font-medium"}=e;const a={dark:"bg-gray-900 text-white dark:bg-gray-700",light:"border-gray-200 bg-white text-gray-900",auto:" bg-white text-gray-900 dark:bg-gray-700 dark:text-white border-gray-200 dark:border-gray-700",custom:""};let d;function u(m){dn.call(this,n,m)}return n.$$set=m=>{t(8,e=Ct(Ct({},e),Ot(m))),t(1,s=xt(e,l)),"type"in m&&t(2,h=m.type),"defaultClass"in m&&t(3,i=m.defaultClass),"$$scope"in m&&t(6,r=m.$$scope)},n.$$.update=()=>{s.color?t(2,h="custom"):t(1,s.color="none",s),["light","auto"].includes(h)&&t(1,s.border=!0,s),t(0,d=An("tooltip",i,a[h],e.class))},e=Ot(e),[d,s,h,i,o,u,r]}class et extends Me{constructor(e){super(),Le(this,e,zn,Bn,Ne,{type:2,defaultClass:3})}}function rn(n=[],e){const t=n.map(r=>r.logit/e),l=t.map(r=>Math.exp(r)),s=l.reduce((r,h)=>r+h,0);return n.map((r,h)=>({...r,adjustedLogit:t[h],adjustedProbability:l[h]/s,adjustedExp:l[h]}))}function an(n){const e=[];let t=0;for(const s of n)t+=s.probability,e.push(t);const l=Math.random();for(let s=0;s<e.length;s++)if(l<e[s])return n[s];return n[0]}const Tn=!0,zo=Object.freeze(Object.defineProperty({__proto__:null,prerender:Tn},Symbol.toStringTag,{value:"Module"}));function Hn(n,e){let t;if(e===void 0)for(const l of n)l!=null&&(t<l||t===void 0&&l>=l)&&(t=l);else{let l=-1;for(let s of n)(s=e(s,++l,n))!=null&&(t<s||t===void 0&&s>=s)&&(t=s)}return t}const{theme:le}=rt(it),ie=200,Rt={"gray-blue":{0:le.colors.gray[ie],100:le.colors.blue[ie]},"gray-blue-last":{0:le.colors.gray[ie],100:le.colors.blue[ie]},"purple-indigo":{0:le.colors.purple[ie],100:le.colors.indigo[ie]},"purple-indigo-last":{0:le.colors.purple[ie],100:le.colors.indigo[ie]},"indigo-blue":{0:le.colors.indigo[ie],100:le.colors.blue[ie]},"indigo-blue-last":{0:le.colors.indigo[ie],100:le.colors.blue[ie]},"blue-white":{0:le.colors.blue[ie],100:le.colors.white},"red-white":{0:le.colors.red[ie],100:le.colors.white},"green-white":{0:le.colors.green[ie],100:le.colors.white},"red-purple":{0:le.colors.red[ie],100:le.colors.purple[ie]},"blue-purple":{90:le.colors.blue[ie],100:le.colors.purple[ie]},"green-purple":{0:le.colors.green[ie],100:le.colors.purple[ie]},"blue-gray":{0:le.colors.blue[ie],100:le.colors.gray[ie]},"blue-white-blue":{0:le.colors.blue[ie],40:le.colors.white,60:le.colors.white,100:le.colors.blue[ie]},"blue-white-blue-last":{0:le.colors.blue[ie],40:le.colors.white,60:le.colors.white,100:le.colors.blue[ie]},"transparent-purple":{0:{color:le.colors.purple[100],opacity:0},100:{color:le.colors.purple[100],opacity:1}},"transparent-purple2":{0:{color:le.colors.purple[400],opacity:0},100:{color:le.colors.purple[200],opacity:1}},"transparent-purple-last":{0:{color:le.colors.purple[100],opacity:0},100:{color:le.colors.purple[100],opacity:1}},"transparent-purple2-last":{0:{color:le.colors.purple[400],opacity:0},100:{color:le.colors.purple[200],opacity:1}},"blue-blue":{0:le.colors.blue[ie],100:le.colors.blue[ie]},"red-red":{0:le.colors.red[ie],100:le.colors.red[ie]},"green-green":{0:le.colors.green[ie],100:le.colors.green[ie]},"blue-blue2":{0:le.colors.blue[ie],100:le.colors.blue[ie]},"red-red2":{0:le.colors.red[ie],100:le.colors.red[ie]},"green-green2":{0:le.colors.green[ie],100:le.colors.green[ie]},"blue-blue-last":{0:le.colors.blue[ie],100:le.colors.blue[ie]},"red-red-last":{0:le.colors.red[ie],100:le.colors.red[ie]},"green-green-last":{0:le.colors.green[ie],100:le.colors.green[ie]},"blue-blue2-last":{0:le.colors.blue[ie],100:le.colors.blue[ie]},"red-red2-last":{0:le.colors.red[ie],100:le.colors.red[ie]},"green-green2-last":{0:le.colors.green[ie],100:le.colors.green[ie]},"gray-gray":{0:le.colors.gray[ie],100:le.colors.gray[ie]},"purple-purple":{0:le.colors.purple[ie],100:le.colors.purple[ie]},"purple-purple-last":{0:le.colors.purple[ie],100:le.colors.purple[ie]}};function Pn(n){let e,t,l,s;return{c(){e=we("svg"),l=we("svg"),this.h()},l(o){e=$e(o,"svg",{id:!0,class:!0,style:!0}),B(e).forEach($),l=$e(o,"svg",{class:!0,style:!0}),B(l).forEach($),this.h()},h(){_(e,"id","back"),_(e,"class","sankey-back absolute left-0 top-0 h-full w-full"),_(e,"style",t=`z-index:${n[2].attention_head_num-1};`),_(l,"class","sankey-top absolute left-0 top-0 h-full w-full svelte-1tshfwi"),_(l,"style",s=`z-index:${n[2].attention_head_num};`)},m(o,r){W(o,e,r),n[4](e),W(o,l,r),n[5](l)},p(o,[r]){r&4&&t!==(t=`z-index:${o[2].attention_head_num-1};`)&&_(e,"style",t),r&4&&s!==(s=`z-index:${o[2].attention_head_num};`)&&_(l,"style",s)},i:qe,o:qe,d(o){o&&($(e),$(l)),n[4](null),n[5](null)}}}const xn=80;function On(n,e,t){let l,s,o;be(n,Ze,D=>t(3,s=D)),be(n,kt,D=>t(2,o=D)),rt(it);let r,h,i;const a={attention:[{from:".attention .query .head-rest",to:".head-block .query .vector",gradientId:"blue-blue2",opacity:.4},{from:".attention .key .head-rest",to:".head-block .key .vector",gradientId:"red-red2",opacity:.4},{from:".attention .value .head-rest",to:".head-block .value .vector",gradientId:"green-green2",opacity:.4},{from:".attention .head-out .vector",to:".mlp .initial .vector .head-rest",gradientId:"transparent-purple",opacity:.4}]},d=()=>{const q=Je(h).append("defs");Object.keys(Rt).forEach(O=>{const y=Rt[O],A=q.append("linearGradient").attr("id",O).attr("x1","0%").attr("y1","0%").attr("x2","100%").attr("y2","0%");Object.keys(y).forEach(T=>{let H,P;typeof y[T]!="string"?(H=y[T].color,P=y[T].opacity):(H=y[T],P=1),A.append("stop").attr("offset",`${T}%`).attr("stop-color",H).attr("stop-opacity",P)})})},u=async()=>{await st();const D=Je(h),q=Je(r);[{dataMap:l,svg:D},{dataMap:a,svg:q}].forEach(({dataMap:O,svg:y})=>{y.selectAll("g.path-group").data(Object.keys(O)).join("g").attr("class",T=>`path-group ${T}`).selectAll("path.sankey-path").data(T=>O[T].map(P=>{const Q=Gt(P.from).nodes(),f=Gt(P.to).nodes();return Q.map((c,v)=>{const p=c.getBoundingClientRect(),k=f[v].getBoundingClientRect(),V=P.curve||xn,b=(P.pathGenerator||m)(p,k,V),g=f.length>1&&v===Q.length-1;let S=P.gradientId;return g&&document.getElementById(P.gradientId+"-last")&&(S=P.gradientId+"-last"),{id:P.id,isLast:v===Q.length-1,path:b,fill:P.type==="stroke"?"none":P.gradientId?`url(#${S})`:P.fill,opacity:P.opacity,stroke:P.type==="stroke"?P.gradientId?`url(#${P.gradientId})`:P.fill:"none"}})}).flat()).join("path").attr("class",T=>`sankey-path ${T.id||""} ${T.isLast?"last":""}`).attr("fill",T=>T.fill).attr("stroke",T=>T.stroke).attr("stroke-width",2).attr("opacity",T=>T.opacity||1).attr("d",T=>T.path)})},m=(D,q,O)=>{const y=window.scrollY,A=window.scrollX;return`
        M ${D.right+A},${D.top+y}
        C ${D.right+A+O},${D.top+y} ${q.left+A-O},${q.top+y} ${q.left+A},${q.top+y}
        L ${q.left+A},${q.bottom+y}
        C ${q.left+A-O},${q.bottom+y} ${D.right+A+O},${D.bottom+y} ${D.right+A},${D.bottom+y}
        Z
    `};dt(()=>(d(),i=new ResizeObserver(q=>{u()}),(document==null?void 0:document.querySelectorAll(".resize-watch")).forEach(q=>i.observe(q)),()=>{i.disconnect()}));function C(D){Ue[D?"unshift":"push"](()=>{r=D,t(0,r)})}function N(D){Ue[D?"unshift":"push"](()=>{h=D,t(1,h)})}return n.$$.update=()=>{n.$$.dirty&8&&(l={embedding:[{from:".embedding .vector-column .column.vectors .vector",to:".attention .vector",gradientId:"gray-blue",opacity:.6,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX,T=30;return`
					M ${D.right+A},${D.top+y}
					L ${D.right+T+A},${D.top+y}
					C ${D.right+T+A+O},${D.top+y} ${q.left+A-O},${q.top+y} ${q.left+A},${q.top+y}
					L ${q.left+A},${q.bottom+y}
					C ${q.left+A-O},${q.bottom+y} ${D.right+T+A+O},${D.bottom+y} ${D.right+T+A},${D.bottom+y}
					L ${D.right+A},${D.bottom+y}
					Z
				`}}],attention:[{from:".attention .query .sub-vector.head1",to:".head-block .query .vector",gradientId:"blue-blue"},{from:".attention .key .sub-vector.head1",to:".head-block .key .vector",gradientId:"red-red"},{from:".attention .value .sub-vector.head1",to:".head-block .value .vector",gradientId:"green-green"},{from:".attention .head-out .vector",to:".mlp .initial .head1",gradientId:"purple-purple"},{from:".head-block .key .vector",to:".attention-initial .main g.g-row",id:"key-to-attention",type:"stroke",gradientId:"red-purple",curve:30,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX,T=D.top+y+D.height/2,H=q.top+y+q.height/2,P=D.right+A+O,Q=q.left+A-O;return`
			    M ${D.right+A},${T}
			    C ${P},${T} ${Q},${H} ${q.left+A},${H}
					L ${q.right+A},${H}
			`}},{from:".head-block .query .vector",to:`.attention-matrix.attention-initial .main g.g-row-${s.length-1} circle`,gradientId:"blue-purple",id:"query-to-attention",type:"stroke",curve:20,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX,T=D.top+y+D.height/2,H=q.left+A+q.width/2;return`
			    M ${D.right+A},${T}
			    L ${H-O},${T}
			    A ${O},${O} 0 0 1 ${H},${T+O}
			    L ${H},${q.bottom+y}
			`}},{from:".attention-matrix.attention-out .main svg",to:".attention .head-out",gradientId:"transparent-purple2",id:"to-attention-out",opacity:.4,curve:20,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX;return`
			    M ${D.right+A},${D.top+y}
			    C ${D.right+A+O},${D.top+y} ${q.left+A-O},${q.top+y} ${q.left+A},${q.top+y}
			    L ${q.left+A},${q.bottom+y}
			    C ${q.left+A-O},${q.bottom+y} ${D.right+A+O},${D.bottom+y} ${D.right+A},${D.bottom+y}
			    Z
			`}},{from:".head-block .value",to:".attention .head-out",gradientId:"green-purple",id:"to-attention-out",opacity:.4,curve:60,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX;return`
        M ${D.right+A},${D.top+y} 
        C ${q.left-O},${D.top+y} ${q.left+A-O},${D.top+y} ${q.left+A},${q.top+y}
        L ${q.left+A},${q.bottom+y}
        C ${q.left+A-O},${D.bottom+y} ${q.left-O},${D.bottom+y} ${D.right+A},${D.bottom+y}
        Z
    `}}],mlp:[{from:".mlp .column.initial .vector",to:".mlp .projections .vector",gradientId:"purple-indigo",curve:50,opacity:.4,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX,T=49;return`
					M ${D.right+A},${D.top+y}
					L ${D.right+T+A},${D.top+y}
					C ${D.right+T+A+O},${D.top+y} ${q.left+A-O},${q.top+y} ${q.left+A},${q.top+y}
					L ${q.left+A},${q.bottom+y}
					C ${q.left+A-O},${q.bottom+y} ${D.right+T+A+O},${D.bottom+y} ${D.right+T+A},${D.bottom+y}
					L ${D.right+A},${D.bottom+y}
					Z
				`}},{from:".mlp .projections .vector",to:".mlp .column.out .vector",gradientId:"indigo-blue",curve:50,opacity:.4,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX,T=20;return`
					M ${D.right+A},${D.top+y}
					C ${D.right+A+O},${D.top+y} ${q.left-T+A-O},${q.top+y} ${q.left-T+A},${q.top+y}
					L ${q.left+A},${q.top+y}
					L ${q.left+A},${q.bottom+y}
					L ${q.left-T+A},${q.bottom+y}
					C ${q.left-T+A-O},${q.bottom+y} ${D.right+A+O},${D.bottom+y} ${D.right+A},${D.bottom+y}
					L ${D.right+A},${D.bottom+y}
					Z
				`}}],"transformer-blocks":[{from:".mlp .out .vector",to:".transformer-blocks .column.final .vector",gradientId:"blue-white-blue",opacity:.6,pathGenerator:(D,q,O)=>{const y=window.scrollY,A=window.scrollX;return`
        M ${D.right+A},${D.top+y}
        C ${D.right+A+O},${D.top+y} ${q.left+A-O},${q.top+y} ${q.left+A},${q.top+y}
        L ${q.left+A},${q.bottom+y}
        C ${q.left+A-O},${q.bottom+y} ${D.right+A+O},${D.bottom+y} ${D.right+A},${D.bottom+y}
        Z
    `}}],"linear-softmax":[{from:".transformer-blocks .final .vector.last-token ",to:".softmax .content .vector",gradientId:"blue-gray",opacity:.4}]}),n.$$.dirty&8&&typeof window<"u"&&u()},[r,h,o,s,C,N]}class jn extends Me{constructor(e){super(),Le(this,e,On,Pn,Ne,{})}}function Ft(n,e,t){const l=n.slice();return l[6]=e[t],l[8]=t,l}function Gn(n){let e,t,l,s,o;return{c(){e=M("div"),t=M("div"),s=G(),this.h()},l(r){e=L(r,"DIV",{class:!0,style:!0});var h=B(e);t=L(h,"DIV",{class:!0,style:!0}),B(t).forEach($),s=R(h),h.forEach($),this.h()},h(){_(t,"class","card svelte-z5n2f7"),_(t,"style",l=`width: ${n[1].width}px; height: ${n[1].height}px;`),_(e,"class","rest absolute"),_(e,"style",o=`transform:translate(${n[8]*Qe.x}px,${n[8]*Qe.y}px) scale(${1-Qe.scale*n[8]}); 
      z-index: ${n[2].attention_head_num-n[8]};opacity:${Math.max(.1,1-n[8]*Wt)};`)},m(r,h){W(r,e,h),I(e,t),I(e,s)},p(r,h){h&2&&l!==(l=`width: ${r[1].width}px; height: ${r[1].height}px;`)&&_(t,"style",l),h&4&&o!==(o=`transform:translate(${r[8]*Qe.x}px,${r[8]*Qe.y}px) scale(${1-Qe.scale*r[8]}); 
      z-index: ${r[2].attention_head_num-r[8]};opacity:${Math.max(.1,1-r[8]*Wt)};`)&&_(e,"style",o)},i:qe,o:qe,d(r){r&&$(e)}}}function Rn(n){let e,t,l;const s=n[4].default,o=Kl(s,n,n[3],null);return{c(){e=M("div"),o&&o.c(),t=G(),this.h()},l(r){e=L(r,"DIV",{class:!0,style:!0});var h=B(e);o&&o.l(h),t=R(h),h.forEach($),this.h()},h(){_(e,"class","w-full"),_(e,"style","z-index: 200;")},m(r,h){W(r,e,h),o&&o.m(e,null),I(e,t),n[5](e),l=!0},p(r,h){o&&o.p&&(!l||h&8)&&Ql(o,s,r,r[3],l?en(s,r[3],h,null):Jl(r[3]),null)},i(r){l||(X(o,r),l=!0)},o(r){te(o,r),l=!1},d(r){r&&$(e),o&&o.d(r),n[5](null)}}}function Ut(n){let e,t,l,s;const o=[Rn,Gn],r=[];function h(i,a){return i[8]===0?0:1}return e=h(n),t=r[e]=o[e](n),{c(){t.c(),l=lt()},l(i){t.l(i),l=lt()},m(i,a){r[e].m(i,a),W(i,l,a),s=!0},p(i,a){t.p(i,a)},i(i){s||(X(t),s=!0)},o(i){te(t),s=!1},d(i){i&&$(l),r[e].d(i)}}}function Fn(n){let e,t,l=ce(Array(n[2].attention_head_num+1).fill(0)),s=[];for(let r=0;r<l.length;r+=1)s[r]=Ut(Ft(n,l,r));const o=r=>te(s[r],1,1,()=>{s[r]=null});return{c(){e=M("div");for(let r=0;r<s.length;r+=1)s[r].c();this.h()},l(r){e=L(r,"DIV",{class:!0});var h=B(e);for(let i=0;i<s.length;i+=1)s[i].l(h);h.forEach($),this.h()},h(){_(e,"class","multi-head flex w-full svelte-z5n2f7")},m(r,h){W(r,e,h);for(let i=0;i<s.length;i+=1)s[i]&&s[i].m(e,null);t=!0},p(r,[h]){if(h&15){l=ce(Array(r[2].attention_head_num+1).fill(0));let i;for(i=0;i<l.length;i+=1){const a=Ft(r,l,i);s[i]?(s[i].p(a,h),X(s[i],1)):(s[i]=Ut(a),s[i].c(),X(s[i],1),s[i].m(e,null))}for(Be(),i=l.length;i<s.length;i+=1)o(i);ze()}},i(r){if(!t){for(let h=0;h<l.length;h+=1)X(s[h]);t=!0}},o(r){s=s.filter(Boolean);for(let h=0;h<s.length;h+=1)te(s[h]);t=!1},d(r){r&&$(e),De(s,r)}}}let Wt=.1;function Un(n,e,t){let l;be(n,kt,a=>t(2,l=a));let{$$slots:s={},$$scope:o}=e,r,h={width:0,height:0};dt(()=>{const a=new ResizeObserver(d=>{for(let u of d){const{width:m,height:C}=u.contentRect;t(1,h={width:m,height:C})}});return a.observe(r),()=>{a.unobserve(r)}});function i(a){Ue[a?"unshift":"push"](()=>{r=a,t(0,r)})}return n.$$set=a=>{"$$scope"in a&&t(3,o=a.$$scope)},[r,h,l,o,s,i]}class Wn extends Me{constructor(e){super(),Le(this,e,Un,Fn,Ne,{})}}const Ye=n=>n.map((e,t)=>{let l=new Array(e.length).fill(-1/0);for(let s=0;s<=t&&s<e.length;s++)l[s]=e[s];return l});function Xn(n){let e,t,l,s,o,r,h="QK<sup>T</sup>",i,a,d,u,m,C,N,D,q,O="Mask",y,A,T,H,P,Q,f,c,v="Softmax",p,k,V,E,b,g,S="Attention",w,z,U,Z,ee,se;return s=new at({props:{className:"main",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),m=new at({props:{className:"prev absolute top-0 left-0 pointer-events-none",data:n[0],showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),N=new at({props:{className:"main opacity-0",data:Ye(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),H=new at({props:{className:"prev absolute top-0 left-0  pointer-events-none",data:Ye(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,shape:"circle",colorScale:"purple"}}),Q=new at({props:{className:"main opacity-0",data:Ye(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!0,shape:"circle",colorScale:"purple"}}),E=new at({props:{className:"main",data:Ye(n[0]),showSize:!1,cellHeight:n[7],cellWidth:n[7],rowGap:3,colGap:3,showValue:!1,shape:"circle",colorScale:"purple"}}),{c(){e=M("div"),t=M("div"),l=M("div"),ue(s.$$.fragment),o=G(),r=M("div"),r.innerHTML=h,a=G(),d=M("div"),u=M("div"),ue(m.$$.fragment),C=G(),ue(N.$$.fragment),D=G(),q=M("div"),q.textContent=O,y=G(),A=M("div"),T=M("div"),ue(H.$$.fragment),P=G(),ue(Q.$$.fragment),f=G(),c=M("div"),c.textContent=v,k=G(),V=M("div"),ue(E.$$.fragment),b=G(),g=M("div"),g.textContent=S,this.h()},l(F){e=L(F,"DIV",{class:!0});var x=B(e);t=L(x,"DIV",{role:!0,tabindex:!0,class:!0});var J=B(t);l=L(J,"DIV",{class:!0});var j=B(l);fe(s.$$.fragment,j),o=R(j),r=L(j,"DIV",{class:!0,"data-svelte-h":!0}),ye(r)!=="svelte-1gw7aya"&&(r.innerHTML=h),j.forEach($),a=R(J),d=L(J,"DIV",{class:!0});var K=B(d);u=L(K,"DIV",{});var Y=B(u);fe(m.$$.fragment,Y),C=R(Y),fe(N.$$.fragment,Y),Y.forEach($),D=R(K),q=L(K,"DIV",{class:!0,"data-svelte-h":!0}),ye(q)!=="svelte-1kil1k9"&&(q.textContent=O),K.forEach($),y=R(J),A=L(J,"DIV",{class:!0});var ve=B(A);T=L(ve,"DIV",{});var ke=B(T);fe(H.$$.fragment,ke),P=R(ke),fe(Q.$$.fragment,ke),ke.forEach($),f=R(ve),c=L(ve,"DIV",{class:!0,"data-svelte-h":!0}),ye(c)!=="svelte-1w9l1cd"&&(c.textContent=v),ve.forEach($),k=R(J),V=L(J,"DIV",{class:!0});var Ve=B(V);fe(E.$$.fragment,Ve),b=R(Ve),g=L(Ve,"DIV",{class:!0,"data-svelte-h":!0}),ye(g)!=="svelte-1t0maa5"&&(g.textContent=S),Ve.forEach($),J.forEach($),x.forEach($),this.h()},h(){_(r,"class","text-gray-400"),_(l,"class",i=re(oe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":n[1]}))+" svelte-1lvbtg6"),_(q,"class","text-gray-400"),_(d,"class","attention-matrix attention-mask flex flex-col items-center svelte-1lvbtg6"),_(c,"class","text-gray-400"),_(A,"class",p=re(oe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":n[1]}))+" svelte-1lvbtg6"),_(g,"class","text-gray-400"),_(V,"class",w=re(oe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!n[1],"attention-out":!n[1]}))+" svelte-1lvbtg6"),tn(()=>n[15].call(V)),_(t,"role","button"),_(t,"tabindex","0"),_(t,"class",U=re(oe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:n[1]}))+" svelte-1lvbtg6"),_(e,"class","flex items-center gap-8 px-10")},m(F,x){W(F,e,x),I(e,t),I(t,l),he(s,l,null),I(l,o),I(l,r),n[11](l),I(t,a),I(t,d),I(d,u),he(m,u,null),I(u,C),he(N,u,null),I(d,D),I(d,q),n[12](d),I(t,y),I(t,A),I(A,T),he(H,T,null),I(T,P),he(Q,T,null),I(A,f),I(A,c),n[13](A),I(t,k),I(t,V),he(E,V,null),I(V,b),I(V,g),n[14](V),z=ln(V,n[15].bind(V)),Z=!0,ee||(se=[_e(t,"click",n[8]),_e(t,"keydown",n[8])],ee=!0)},p(F,[x]){const J={};x&1&&(J.data=F[0]),x&128&&(J.cellHeight=F[7]),x&128&&(J.cellWidth=F[7]),s.$set(J),(!Z||x&2&&i!==(i=re(oe("attention-matrix attention-qk flex flex-col items-center",{"attention-initial":F[1]}))+" svelte-1lvbtg6"))&&_(l,"class",i);const j={};x&1&&(j.data=F[0]),x&128&&(j.cellHeight=F[7]),x&128&&(j.cellWidth=F[7]),m.$set(j);const K={};x&1&&(K.data=Ye(F[0])),x&128&&(K.cellHeight=F[7]),x&128&&(K.cellWidth=F[7]),N.$set(K);const Y={};x&1&&(Y.data=Ye(F[0])),x&128&&(Y.cellHeight=F[7]),x&128&&(Y.cellWidth=F[7]),H.$set(Y);const ve={};x&1&&(ve.data=Ye(F[0])),x&128&&(ve.cellHeight=F[7]),x&128&&(ve.cellWidth=F[7]),Q.$set(ve),(!Z||x&2&&p!==(p=re(oe("attention-matrix attention-softmax flex flex-col items-center",{"attention-out":F[1]}))+" svelte-1lvbtg6"))&&_(A,"class",p);const ke={};x&1&&(ke.data=Ye(F[0])),x&128&&(ke.cellHeight=F[7]),x&128&&(ke.cellWidth=F[7]),E.$set(ke),(!Z||x&2&&w!==(w=re(oe("attention-matrix attention-result flex flex-col items-center",{"attention-initial":!F[1],"attention-out":!F[1]}))+" svelte-1lvbtg6"))&&_(V,"class",w),(!Z||x&2&&U!==(U=re(oe("attention-matrix-container relative flex gap-3 p-3 pb-1",{active:F[1]}))+" svelte-1lvbtg6"))&&_(t,"class",U)},i(F){Z||(X(s.$$.fragment,F),X(m.$$.fragment,F),X(N.$$.fragment,F),X(H.$$.fragment,F),X(Q.$$.fragment,F),X(E.$$.fragment,F),Z=!0)},o(F){te(s.$$.fragment,F),te(m.$$.fragment,F),te(N.$$.fragment,F),te(H.$$.fragment,F),te(Q.$$.fragment,F),te(E.$$.fragment,F),Z=!1},d(F){F&&$(e),de(s),n[11](null),de(m),de(N),n[12](null),de(H),de(Q),n[13](null),de(E),n[14](null),z(),ee=!1,Pe(se)}}}let Zn=16,Yn=20,Kn=10;function Qn(n,e,t){let l,s,o;be(n,Ze,f=>t(9,s=f)),be(n,Re,f=>t(10,o=f)),rt(it);let{data:r}=e,h,i,a,d,u=0,m=!1;const C=_t("block-id"),N=()=>{t(1,m=!m),m?(Re.set({id:C}),O()):(Re.set({id:null}),y())};let D=ot.timeline(),q=ot.timeline();const O=()=>{q.progress(1);const f=document.querySelectorAll("div.sankey g.attention path.key-to-attention"),c=document.querySelectorAll("div.sankey g.attention path.query-to-attention"),v=document.querySelectorAll("div.sankey g.attention path.to-attention-out");[...f,...c].forEach(V=>{const E=V.getTotalLength();V.style.strokeDasharray=E,V.style.strokeDashoffset=E});const p=1.2,k=Number((p/s.length).toFixed(2));D.set([i.querySelector(".prev"),a.querySelector(".prev")],{opacity:1}).set([i.querySelector(".main"),a.querySelector(".main")],{opacity:0}),D.set(v,{opacity:0}),D.to(d,{opacity:0,display:"none",duration:.2}),D.set(h,{width:"auto",display:"flex",opacity:0}).to(h,{opacity:1,duration:.5}).to(f,{strokeDashoffset:0,stagger:k,duration:p,ease:"power2.out"}).to(c,{strokeDashoffset:0,stagger:k,duration:p,ease:"power2.out"},"<").from(h.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:p/s.length,stagger:Number((p/Math.pow(s.length,2)).toFixed(2)),ease:"power2.out",duration:p},"<"),D.set(i,{width:0,x:u*-1,opacity:0}).to(i,{opacity:1,display:"flex",width:u,x:0,duration:.5}).to(i.querySelector(".prev"),{opacity:0,duration:1}).to(i.querySelector(".main"),{opacity:1,duration:1},"<"),D.set(a,{width:0,x:u*-1,opacity:0}).to(a,{opacity:1,display:"flex",width:u,x:0,duration:.4}).to(a.querySelector(".prev"),{opacity:0,duration:1}).to(a.querySelector(".main"),{opacity:1,duration:1},"<"),D.to(v,{opacity:.5})},y=()=>{D.progress(1),q.to([h,i,a],{opacity:0,display:"none",width:0,duration:.5}),q.to(d,{opacity:1,display:"flex",duration:.5},0)};function A(f){Ue[f?"unshift":"push"](()=>{h=f,t(2,h)})}function T(f){Ue[f?"unshift":"push"](()=>{i=f,t(3,i)})}function H(f){Ue[f?"unshift":"push"](()=>{a=f,t(4,a)})}function P(f){Ue[f?"unshift":"push"](()=>{d=f,t(5,d)})}function Q(){u=this.offsetWidth,t(6,u)}return n.$$set=f=>{"data"in f&&t(0,r=f.data)},n.$$.update=()=>{n.$$.dirty&512&&t(7,l=Math.min(Yn,Math.max(1/s.length*Zn*6,Kn))),n.$$.dirty&1026&&o.id!==C&&m&&(t(1,m=!1),y())},[r,m,h,i,a,d,u,l,N,s,o,A,T,H,P,Q]}class Jn extends Me{constructor(e){super(),Le(this,e,Qn,Xn,Ne,{data:0})}}function es(n){let e;return{c(){e=M("canvas"),this.h()},l(t){e=L(t,"CANVAS",{class:!0}),B(e).forEach($),this.h()},h(){_(e,"class","svelte-nphsb9"),ne(e,"active",n[0])},m(t,l){W(t,e,l),n[4](e)},p(t,[l]){l&1&&ne(e,"active",t[0])},i:qe,o:qe,d(t){t&&$(e),n[4](null)}}}const yt=1;function ts(n,e,t){const{theme:l}=rt(it);let{active:s=!1}=e,{data:o=[]}=e,{colorScale:r=void 0}=e,h;const i=typeof r=="string"?r:"gray",a=typeof r=="function"?r:In(l.colors[i][100],l.colors[i][500]);function d(){const m=h.getContext("2d");if(!m)return;const C=h.parentElement.clientWidth,N=h.parentElement.clientHeight;m.clearRect(0,0,C,N);let D=4;t(1,h.width=C*D,h),t(1,h.height=N*D,h),t(1,h.style.width=`${C}px`,h),t(1,h.style.height=`${N}px`,h);for(let q=0;q<N/yt;q++){const O=o[q%o.length];m.fillStyle=a(O),m.fillRect(0,q*yt*D,C*D,yt*D)}}function u(m){Ue[m?"unshift":"push"](()=>{h=m,t(1,h)})}return n.$$set=m=>{"active"in m&&t(0,s=m.active),"data"in m&&t(2,o=m.data),"colorScale"in m&&t(3,r=m.colorScale)},n.$$.update=()=>{n.$$.dirty&6&&o&&h&&d()},[s,h,o,r,u]}class At extends Me{constructor(e){super(),Le(this,e,ts,es,Ne,{active:0,data:2,colorScale:3})}}function Xt(n,e,t){const l=n.slice();return l[12]=e[t],l[14]=t,l}function Zt(n,e,t){const l=n.slice();return l[12]=e[t],l[14]=t,l}function Yt(n,e,t){const l=n.slice();return l[12]=e[t],l[14]=t,l}function Kt(n,e,t){const l=n.slice();return l[12]=e[t],l[14]=t,l}function Qt(n,e,t){const l=n.slice();return l[12]=e[t],l[14]=t,l}function ls(n){let e,t=n[5].dimension*3+"",l,s;return{c(){e=pe("size(1, "),l=pe(t),s=pe(")")},l(o){e=ge(o,"size(1, "),l=ge(o,t),s=ge(o,")")},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r&32&&t!==(t=o[5].dimension*3+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function ns(n){let e,t=n[5].dimension/n[5].attention_head_num+"",l,s;return{c(){e=pe("Head1 Query, size(1, "),l=pe(t),s=pe(")")},l(o){e=ge(o,"Head1 Query, size(1, "),l=ge(o,t),s=ge(o,")")},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r&32&&t!==(t=o[5].dimension/o[5].attention_head_num+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function ss(n){let e,t=n[5].dimension/n[5].attention_head_num+"",l,s;return{c(){e=pe("Head1 Key, size(1, "),l=pe(t),s=pe(")")},l(o){e=ge(o,"Head1 Key, size(1, "),l=ge(o,t),s=ge(o,")")},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r&32&&t!==(t=o[5].dimension/o[5].attention_head_num+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function os(n){let e,t=n[5].dimension/n[5].attention_head_num+"",l,s;return{c(){e=pe("Head1 Value size(1, "),l=pe(t),s=pe(")")},l(o){e=ge(o,"Head1 Value size(1, "),l=ge(o,t),s=ge(o,")")},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r&32&&t!==(t=o[5].dimension/o[5].attention_head_num+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function rs(n){let e,t=n[5].dimension/n[5].attention_head_num+"",l,s;return{c(){e=pe("Head1 Attention Out, size(1, "),l=pe(t),s=pe(")")},l(o){e=ge(o,"Head1 Attention Out, size(1, "),l=ge(o,t),s=ge(o,")")},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r&32&&t!==(t=o[5].dimension/o[5].attention_head_num+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function is(n){let e,t="Q";return{c(){e=M("span"),e.textContent=t},l(l){e=L(l,"SPAN",{"data-svelte-h":!0}),ye(e)!=="svelte-10ub4hf"&&(e.textContent=t)},m(l,s){W(l,e,s)},d(l){l&&$(e)}}}function as(n){let e,t="K";return{c(){e=M("span"),e.textContent=t},l(l){e=L(l,"SPAN",{"data-svelte-h":!0}),ye(e)!=="svelte-1c09r6x"&&(e.textContent=t)},m(l,s){W(l,e,s)},d(l){l&&$(e)}}}function cs(n){let e,t="V";return{c(){e=M("span"),e.textContent=t},l(l){e=L(l,"SPAN",{"data-svelte-h":!0}),ye(e)!=="svelte-j40kxg"&&(e.textContent=t)},m(l,s){W(l,e,s)},d(l){l&&$(e)}}}function Jt(n){let e,t,l,s,o,r,h,i,a,d,u,m,C,N,D,q,O=is(),y=as(),A=cs();return{c(){e=M("div"),t=M("div"),l=M("div"),s=G(),o=M("div"),O&&O.c(),r=G(),h=M("div"),i=M("div"),a=G(),d=M("div"),y&&y.c(),u=G(),m=M("div"),C=M("div"),N=G(),D=M("div"),A&&A.c(),q=G(),this.h()},l(T){e=L(T,"DIV",{class:!0});var H=B(e);t=L(H,"DIV",{class:!0});var P=B(t);l=L(P,"DIV",{class:!0}),B(l).forEach($),s=R(P),o=L(P,"DIV",{class:!0});var Q=B(o);O&&O.l(Q),Q.forEach($),P.forEach($),r=R(H),h=L(H,"DIV",{class:!0});var f=B(h);i=L(f,"DIV",{class:!0}),B(i).forEach($),a=R(f),d=L(f,"DIV",{class:!0});var c=B(d);y&&y.l(c),c.forEach($),f.forEach($),u=R(H),m=L(H,"DIV",{class:!0});var v=B(m);C=L(v,"DIV",{class:!0}),B(C).forEach($),N=R(v),D=L(v,"DIV",{class:!0});var p=B(D);A&&A.l(p),p.forEach($),v.forEach($),q=R(H),H.forEach($),this.h()},h(){_(l,"class",re(`sub-vector x1-12 head1 ${cn}`)+" svelte-1m1b7zh"),_(o,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(t,"class",re(`sub-vector query flex grow flex-col ${hs}`)+" svelte-1m1b7zh"),_(i,"class",re(`sub-vector x1-12 head1 ${un}`)+" svelte-1m1b7zh"),_(d,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(h,"class",re(`sub-vector key flex grow flex-col ${ds}`)+" svelte-1m1b7zh"),_(C,"class",re(`sub-vector x1-12 head1 ${fn}`)+" svelte-1m1b7zh"),_(D,"class","sub-vector head-rest grow svelte-1m1b7zh"),_(m,"class",re(`sub-vector value flex grow flex-col ${ps}`)+" svelte-1m1b7zh"),_(e,"class","qkv-weighted vector x3 flex flex-col"),ne(e,"last",n[14]===n[1].length-1)},m(T,H){W(T,e,H),I(e,t),I(t,l),I(t,s),I(t,o),O&&O.m(o,null),I(e,r),I(e,h),I(h,i),I(h,a),I(h,d),y&&y.m(d,null),I(e,u),I(e,m),I(m,C),I(m,N),I(m,D),A&&A.m(D,null),I(e,q)},p(T,H){H&2&&ne(e,"last",T[14]===T[1].length-1)},d(T){T&&$(e),O&&O.d(),y&&y.d(),A&&A.d()}}}function el(n){let e,t,l=n[12]+"",s,o,r,h;return{c(){e=M("div"),t=M("span"),s=pe(l),o=G(),r=M("div"),h=G(),this.h()},l(i){e=L(i,"DIV",{class:!0});var a=B(e);t=L(a,"SPAN",{class:!0});var d=B(t);s=ge(d,l),d.forEach($),o=R(a),r=L(a,"DIV",{class:!0}),B(r).forEach($),h=R(a),a.forEach($),this.h()},h(){_(t,"class","label float svelte-1m1b7zh"),_(r,"class",re(`vector x1-12  ${cn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),ne(e,"last",n[14]===n[1].length-1)},m(i,a){W(i,e,a),I(e,t),I(t,s),I(e,o),I(e,r),I(e,h)},p(i,a){a&2&&l!==(l=i[12]+"")&&Se(s,l),a&2&&ne(e,"last",i[14]===i[1].length-1)},d(i){i&&$(e)}}}function tl(n){let e,t,l=n[12]+"",s,o,r,h,i;return{c(){e=M("div"),t=M("span"),s=pe(l),o=G(),r=M("div"),h=G(),this.h()},l(a){e=L(a,"DIV",{class:!0});var d=B(e);t=L(d,"SPAN",{class:!0});var u=B(t);s=ge(u,l),u.forEach($),o=R(d),r=L(d,"DIV",{class:!0}),B(r).forEach($),h=R(d),d.forEach($),this.h()},h(){_(t,"class","label float svelte-1m1b7zh"),_(r,"class",re(`vector x1-12 ${un}`)+" svelte-1m1b7zh"),_(e,"class",i="head1 cell x1-12 text-xs class:last="+(n[14]===n[1].length-1)+" svelte-1m1b7zh")},m(a,d){W(a,e,d),I(e,t),I(t,s),I(e,o),I(e,r),I(e,h)},p(a,d){d&2&&l!==(l=a[12]+"")&&Se(s,l),d&2&&i!==(i="head1 cell x1-12 text-xs class:last="+(a[14]===a[1].length-1)+" svelte-1m1b7zh")&&_(e,"class",i)},d(a){a&&$(e)}}}function ll(n){let e,t,l=n[12]+"",s,o,r,h;return{c(){e=M("div"),t=M("span"),s=pe(l),o=G(),r=M("div"),h=G(),this.h()},l(i){e=L(i,"DIV",{class:!0});var a=B(e);t=L(a,"SPAN",{class:!0});var d=B(t);s=ge(d,l),d.forEach($),o=R(a),r=L(a,"DIV",{class:!0}),B(r).forEach($),h=R(a),a.forEach($),this.h()},h(){_(t,"class","label float svelte-1m1b7zh"),_(r,"class",re(`vector x1-12 ${fn}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12 text-xs"),ne(e,"last",n[14]===n[1].length-1)},m(i,a){W(i,e,a),I(e,t),I(t,s),I(e,o),I(e,r),I(e,h)},p(i,a){a&2&&l!==(l=i[12]+"")&&Se(s,l),a&2&&ne(e,"last",i[14]===i[1].length-1)},d(i){i&&$(e)}}}function nl(n){let e,t,l;return{c(){e=M("div"),t=M("div"),l=G(),this.h()},l(s){e=L(s,"DIV",{class:!0});var o=B(e);t=L(o,"DIV",{class:!0}),B(t).forEach($),l=R(o),o.forEach($),this.h()},h(){_(t,"class",re(`vector x1-12 ${gs}`)+" svelte-1m1b7zh"),_(e,"class","head1 cell x1-12"),ne(e,"last",n[14]===n[1].length-1)},m(s,o){W(s,e,o),I(e,t),I(e,l)},p(s,o){o&2&&ne(e,"last",s[14]===s[1].length-1)},d(s){s&&$(e)}}}function us(n){let e,t,l,s,o="Query",r,h,i,a,d="Key",u,m,C,N,D="Value",q,O,y,A,T,H,P,Q,f="Out",c,v,p,k,V=n[5].attention_head_num+"",E,b,g,S=ce(n[1]),w=[];for(let x=0;x<S.length;x+=1)w[x]=el(Kt(n,S,x));let z=ce(n[1]),U=[];for(let x=0;x<z.length;x+=1)U[x]=tl(Yt(n,z,x));let Z=ce(n[1]),ee=[];for(let x=0;x<Z.length;x+=1)ee[x]=ll(Zt(n,Z,x));A=new Jn({props:{data:n[3]}});let se=ce(n[1]),F=[];for(let x=0;x<se.length;x+=1)F[x]=nl(Xt(n,se,x));return{c(){e=M("div"),t=M("div"),l=M("div"),s=M("div"),s.textContent=o,r=G();for(let x=0;x<w.length;x+=1)w[x].c();h=G(),i=M("div"),a=M("div"),a.textContent=d,u=G();for(let x=0;x<U.length;x+=1)U[x].c();m=G(),C=M("div"),N=M("div"),N.textContent=D,q=G();for(let x=0;x<ee.length;x+=1)ee[x].c();O=G(),y=M("div"),ue(A.$$.fragment),T=G(),H=M("div"),P=M("div"),Q=M("div"),Q.textContent=f,c=G();for(let x=0;x<F.length;x+=1)F[x].c();v=G(),p=M("div"),k=pe("Head 1 of "),E=pe(V),this.h()},l(x){e=L(x,"DIV",{class:!0,style:!0});var J=B(e);t=L(J,"DIV",{class:!0});var j=B(t);l=L(j,"DIV",{class:!0});var K=B(l);s=L(K,"DIV",{class:!0,"data-svelte-h":!0}),ye(s)!=="svelte-1a2739d"&&(s.textContent=o),r=R(K);for(let ae=0;ae<w.length;ae+=1)w[ae].l(K);K.forEach($),h=R(j),i=L(j,"DIV",{class:!0});var Y=B(i);a=L(Y,"DIV",{class:!0,"data-svelte-h":!0}),ye(a)!=="svelte-bmmhtu"&&(a.textContent=d),u=R(Y);for(let ae=0;ae<U.length;ae+=1)U[ae].l(Y);Y.forEach($),m=R(j),C=L(j,"DIV",{class:!0});var ve=B(C);N=L(ve,"DIV",{class:!0,"data-svelte-h":!0}),ye(N)!=="svelte-17pe084"&&(N.textContent=D),q=R(ve);for(let ae=0;ae<ee.length;ae+=1)ee[ae].l(ve);ve.forEach($),j.forEach($),O=R(J),y=L(J,"DIV",{class:!0});var ke=B(y);fe(A.$$.fragment,ke),ke.forEach($),T=R(J),H=L(J,"DIV",{class:!0});var Ve=B(H);P=L(Ve,"DIV",{class:!0});var Ee=B(P);Q=L(Ee,"DIV",{class:!0,"data-svelte-h":!0}),ye(Q)!=="svelte-68unf9"&&(Q.textContent=f),c=R(Ee);for(let ae=0;ae<F.length;ae+=1)F[ae].l(Ee);Ee.forEach($),Ve.forEach($),v=R(J),p=L(J,"DIV",{class:!0});var Ie=B(p);k=ge(Ie,"Head 1 of "),E=ge(Ie,V),Ie.forEach($),J.forEach($),this.h()},h(){_(s,"class","title svelte-1m1b7zh"),_(l,"class","column query"),_(a,"class","title svelte-1m1b7zh"),_(i,"class","column key"),_(N,"class","title svelte-1m1b7zh"),_(C,"class","column value"),_(t,"class","qkv flex h-full flex-col justify-center gap-[5rem] pl-[6rem]"),_(y,"class","resize-watch attention-matrix flex"),_(Q,"class","title svelte-1m1b7zh"),_(P,"class","column out"),_(H,"class","head-out mx-[2rem]"),_(p,"class","head-title absolute bottom-2 right-3 text-right text-gray-400"),_(e,"class","head-block flex w-full items-center justify-between px-2"),_(e,"style",b=`height:${n[6]}px;`)},m(x,J){W(x,e,J),I(e,t),I(t,l),I(l,s),I(l,r);for(let j=0;j<w.length;j+=1)w[j]&&w[j].m(l,null);I(t,h),I(t,i),I(i,a),I(i,u);for(let j=0;j<U.length;j+=1)U[j]&&U[j].m(i,null);I(t,m),I(t,C),I(C,N),I(C,q);for(let j=0;j<ee.length;j+=1)ee[j]&&ee[j].m(C,null);I(e,O),I(e,y),he(A,y,null),I(e,T),I(e,H),I(H,P),I(P,Q),I(P,c);for(let j=0;j<F.length;j+=1)F[j]&&F[j].m(P,null);I(e,v),I(e,p),I(p,k),I(p,E),g=!0},p(x,J){if(J&2){S=ce(x[1]);let K;for(K=0;K<S.length;K+=1){const Y=Kt(x,S,K);w[K]?w[K].p(Y,J):(w[K]=el(Y),w[K].c(),w[K].m(l,null))}for(;K<w.length;K+=1)w[K].d(1);w.length=S.length}if(J&2){z=ce(x[1]);let K;for(K=0;K<z.length;K+=1){const Y=Yt(x,z,K);U[K]?U[K].p(Y,J):(U[K]=tl(Y),U[K].c(),U[K].m(i,null))}for(;K<U.length;K+=1)U[K].d(1);U.length=z.length}if(J&2){Z=ce(x[1]);let K;for(K=0;K<Z.length;K+=1){const Y=Zt(x,Z,K);ee[K]?ee[K].p(Y,J):(ee[K]=ll(Y),ee[K].c(),ee[K].m(C,null))}for(;K<ee.length;K+=1)ee[K].d(1);ee.length=Z.length}const j={};if(J&8&&(j.data=x[3]),A.$set(j),J&2){se=ce(x[1]);let K;for(K=0;K<se.length;K+=1){const Y=Xt(x,se,K);F[K]?F[K].p(Y,J):(F[K]=nl(Y),F[K].c(),F[K].m(P,null))}for(;K<F.length;K+=1)F[K].d(1);F.length=se.length}(!g||J&32)&&V!==(V=x[5].attention_head_num+"")&&Se(E,V),(!g||J&64&&b!==(b=`height:${x[6]}px;`))&&_(e,"style",b)},i(x){g||(X(A.$$.fragment,x),g=!0)},o(x){te(A.$$.fragment,x),g=!1},d(x){x&&$(e),De(w,x),De(U,x),De(ee,x),de(A),De(F,x)}}}function fs(n){let e,t,l="<div>Multi-head Self Attention</div>",s,o,r,h,i,a,d,u,m,C,N,D,q,O,y,A,T,H,P,Q,f,c,v,p,k;m=new et({props:{triggeredBy:".attention .qkv-weighted",placement:"right",class:"popover text-sm font-light",$$slots:{default:[ls]},$$scope:{ctx:n}}}),N=new et({props:{triggeredBy:".attention .query .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[ns]},$$scope:{ctx:n}}}),q=new et({props:{triggeredBy:".attention .key .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[ss]},$$scope:{ctx:n}}}),y=new et({props:{triggeredBy:".attention .value .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[os]},$$scope:{ctx:n}}}),T=new et({props:{triggeredBy:".attention .out .head1",placement:"right",class:"popover text-sm font-light",$$slots:{default:[rs]},$$scope:{ctx:n}}});let V=ce(n[1]),E=[];for(let b=0;b<V.length;b+=1)E[b]=Jt(Qt(n,V,b));return f=new Wn({props:{$$slots:{default:[us]},$$scope:{ctx:n}}}),{c(){e=M("div"),t=M("div"),t.innerHTML=l,s=G(),o=M("div"),r=M("div"),h=G(),i=M("div"),d=G(),u=M("div"),ue(m.$$.fragment),C=G(),ue(N.$$.fragment),D=G(),ue(q.$$.fragment),O=G(),ue(y.$$.fragment),A=G(),ue(T.$$.fragment),H=G();for(let b=0;b<E.length;b+=1)E[b].c();P=G(),Q=M("div"),ue(f.$$.fragment),this.h()},l(b){e=L(b,"DIV",{class:!0});var g=B(e);t=L(g,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),ye(t)!=="svelte-n6swon"&&(t.innerHTML=l),s=R(g),o=L(g,"DIV",{class:!0});var S=B(o);r=L(S,"DIV",{class:!0}),B(r).forEach($),h=R(S),i=L(S,"DIV",{class:!0,style:!0}),B(i).forEach($),d=R(S),u=L(S,"DIV",{class:!0});var w=B(u);fe(m.$$.fragment,w),C=R(w),fe(N.$$.fragment,w),D=R(w),fe(q.$$.fragment,w),O=R(w),fe(y.$$.fragment,w),A=R(w),fe(T.$$.fragment,w),H=R(w);for(let U=0;U<E.length;U+=1)E[U].l(w);w.forEach($),P=R(S),Q=L(S,"DIV",{class:!0});var z=B(Q);fe(f.$$.fragment,z),z.forEach($),S.forEach($),g.forEach($),this.h()},h(){_(t,"class","title svelte-1m1b7zh"),_(t,"role","group"),_(r,"class","bounding transformer-bounding svelte-1m1b7zh"),ne(r,"active",n[4]),_(i,"class","bounding attention-bounding svelte-1m1b7zh"),_(i,"style",a=`padding-bottom:${n[5].attention_head_num*Qe.y}px`),ne(i,"active",n[2]&&!n[7]),_(u,"class","column"),_(Q,"class","heads svelte-1m1b7zh"),_(o,"class","content relative svelte-1m1b7zh"),_(e,"class",c=re(oe("attention",n[0]))+" svelte-1m1b7zh")},m(b,g){W(b,e,g),I(e,t),I(e,s),I(e,o),I(o,r),I(o,h),I(o,i),I(o,d),I(o,u),he(m,u,null),I(u,C),he(N,u,null),I(u,D),he(q,u,null),I(u,O),he(y,u,null),I(u,A),he(T,u,null),I(u,H);for(let S=0;S<E.length;S+=1)E[S]&&E[S].m(u,null);I(o,P),I(o,Q),he(f,Q,null),v=!0,p||(k=[_e(t,"mouseenter",n[8]),_e(t,"mouseleave",n[9])],p=!0)},p(b,[g]){(!v||g&16)&&ne(r,"active",b[4]),(!v||g&32&&a!==(a=`padding-bottom:${b[5].attention_head_num*Qe.y}px`))&&_(i,"style",a),(!v||g&132)&&ne(i,"active",b[2]&&!b[7]);const S={};g&524320&&(S.$$scope={dirty:g,ctx:b}),m.$set(S);const w={};g&524320&&(w.$$scope={dirty:g,ctx:b}),N.$set(w);const z={};g&524320&&(z.$$scope={dirty:g,ctx:b}),q.$set(z);const U={};g&524320&&(U.$$scope={dirty:g,ctx:b}),y.$set(U);const Z={};if(g&524320&&(Z.$$scope={dirty:g,ctx:b}),T.$set(Z),g&2){V=ce(b[1]);let se;for(se=0;se<V.length;se+=1){const F=Qt(b,V,se);E[se]?E[se].p(F,g):(E[se]=Jt(F),E[se].c(),E[se].m(u,null))}for(;se<E.length;se+=1)E[se].d(1);E.length=V.length}const ee={};g&524394&&(ee.$$scope={dirty:g,ctx:b}),f.$set(ee),(!v||g&1&&c!==(c=re(oe("attention",b[0]))+" svelte-1m1b7zh"))&&_(e,"class",c)},i(b){v||(X(m.$$.fragment,b),X(N.$$.fragment,b),X(q.$$.fragment,b),X(y.$$.fragment,b),X(T.$$.fragment,b),X(f.$$.fragment,b),v=!0)},o(b){te(m.$$.fragment,b),te(N.$$.fragment,b),te(q.$$.fragment,b),te(y.$$.fragment,b),te(T.$$.fragment,b),te(f.$$.fragment,b),v=!1},d(b){b&&$(e),de(m),de(N),de(q),de(y),de(T),De(E,b),de(f),p=!1,Pe(k)}}}const hs="bg-blue-200",ds="bg-red-200",ps="bg-green-200",cn="bg-blue-300",un="bg-red-300",fn="bg-green-300",gs="bg-purple-300";function ms(n,e,t){let l,s,o,r,h,i;be(n,Ze,D=>t(1,s=D)),be(n,Re,D=>t(10,o=D)),be(n,ht,D=>t(4,r=D)),be(n,kt,D=>t(5,h=D)),be(n,nn,D=>t(6,i=D));let{className:a=void 0}=e;bt("block-id","attention");const d=_t("block-id");let u=o.id===d,m=!1;function C(){t(2,m=!0)}function N(){t(2,m=!1)}return n.$$set=D=>{"className"in D&&t(0,a=D.className)},n.$$.update=()=>{n.$$.dirty&2&&t(3,l=Array(s.length).fill(0).map(D=>Array(s.length).fill(0).map(q=>Math.random())))},[a,s,m,l,r,h,i,u,C,N]}class vs extends Me{constructor(e){super(),Le(this,e,ms,fs,Ne,{className:0})}}function _s(n){let e,t,l,s,o,r,h,i=n[2]&&sl();return{c(){e=M("div"),t=M("div"),l=G(),s=we("svg"),i&&i.c(),o=we("path"),this.h()},l(a){e=L(a,"DIV",{class:!0});var d=B(e);t=L(d,"DIV",{class:!0}),B(t).forEach($),l=R(d),s=$e(d,"svg",{class:!0});var u=B(s);i&&i.l(u),o=$e(u,"path",{d:!0,class:!0}),B(o).forEach($),u.forEach($),d.forEach($),this.h()},h(){_(t,"class","cursor svelte-1vlmsuq"),_(o,"d",r=`M0,0 L0,${n[5]}`),_(o,"class","svelte-1vlmsuq"),_(s,"class","main svelte-1vlmsuq"),_(e,"class",h=re(oe("residual residual-end cell",n[0]))+" svelte-1vlmsuq"),ne(e,"active",n[4])},m(a,d){W(a,e,d),I(e,t),I(e,l),I(e,s),i&&i.m(s,null),I(s,o)},p(a,d){a[2]?i||(i=sl(),i.c(),i.m(s,o)):i&&(i.d(1),i=null),d&32&&r!==(r=`M0,0 L0,${a[5]}`)&&_(o,"d",r),d&1&&h!==(h=re(oe("residual residual-end cell",a[0]))+" svelte-1vlmsuq")&&_(e,"class",h),d&17&&ne(e,"active",a[4])},d(a){a&&$(e),i&&i.d()}}}function bs(n){let e,t,l,s,o,r,h,i=n[2]&&ol();return{c(){e=M("div"),t=M("div"),l=G(),s=we("svg"),i&&i.c(),o=we("path"),this.h()},l(a){e=L(a,"DIV",{class:!0});var d=B(e);t=L(d,"DIV",{class:!0}),B(t).forEach($),l=R(d),s=$e(d,"svg",{class:!0});var u=B(s);i&&i.l(u),o=$e(u,"path",{d:!0,class:!0}),B(o).forEach($),u.forEach($),d.forEach($),this.h()},h(){_(t,"class","cursor svelte-1vlmsuq"),_(o,"d",r=`M0,0 L0,${n[5]}`),_(o,"class","svelte-1vlmsuq"),_(s,"class","main svelte-1vlmsuq"),_(e,"class",h=re(oe("residual residual-start cell",n[0]))+" svelte-1vlmsuq"),ne(e,"active",n[4])},m(a,d){W(a,e,d),I(e,t),I(e,l),I(e,s),i&&i.m(s,null),I(s,o)},p(a,d){a[2]?i||(i=ol(),i.c(),i.m(s,o)):i&&(i.d(1),i=null),d&32&&r!==(r=`M0,0 L0,${a[5]}`)&&_(o,"d",r),d&1&&h!==(h=re(oe("residual residual-start cell",a[0]))+" svelte-1vlmsuq")&&_(e,"class",h),d&17&&ne(e,"active",a[4])},d(a){a&&$(e),i&&i.d()}}}function ks(n){let e,t,l,s,o,r,h,i,a,d=n[3]&&rl();return{c(){e=M("div"),t=M("div"),l=G(),s=we("svg"),o=we("circle"),r=we("path"),i=G(),d&&d.c(),this.h()},l(u){e=L(u,"DIV",{class:!0});var m=B(e);t=L(m,"DIV",{class:!0}),B(t).forEach($),l=R(m),s=$e(m,"svg",{class:!0});var C=B(s);o=$e(C,"circle",{class:!0,cx:!0,cy:!0,r:!0}),B(o).forEach($),r=$e(C,"path",{class:!0,d:!0}),B(r).forEach($),C.forEach($),i=R(m),d&&d.l(m),m.forEach($),this.h()},h(){_(t,"class","cursor svelte-1vlmsuq"),_(o,"class","icon svelte-1vlmsuq"),_(o,"cx","50%"),_(o,"cy","50%"),_(o,"r","3"),_(r,"class","line svelte-1vlmsuq"),_(r,"d",h=`
     M 0 0
    C 0 ${n[5]*.25}, ${n[5]*.2} ${n[5]*.25}, ${n[5]*.2} ${n[5]*.5}
    C ${n[5]*.2} ${n[5]*.75}, 0 ${n[5]*.75}, 0 ${n[5]}
  `),_(s,"class","main svelte-1vlmsuq"),_(e,"class",a=re(oe("cell ln",n[0]))+" svelte-1vlmsuq"),ne(e,"active",n[4])},m(u,m){W(u,e,m),I(e,t),I(e,l),I(e,s),I(s,o),I(s,r),I(e,i),d&&d.m(e,null)},p(u,m){m&32&&h!==(h=`
     M 0 0
    C 0 ${u[5]*.25}, ${u[5]*.2} ${u[5]*.25}, ${u[5]*.2} ${u[5]*.5}
    C ${u[5]*.2} ${u[5]*.75}, 0 ${u[5]*.75}, 0 ${u[5]}
  `)&&_(r,"d",h),u[3]?d||(d=rl(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&1&&a!==(a=re(oe("cell ln",u[0]))+" svelte-1vlmsuq")&&_(e,"class",a),m&17&&ne(e,"active",u[4])},d(u){u&&$(e),d&&d.d()}}}function ws(n){let e,t,l,s,o,r,h,i,a,d=n[3]&&il();return{c(){e=M("div"),t=M("div"),l=G(),s=we("svg"),o=we("path"),h=we("circle"),i=G(),d&&d.c(),this.h()},l(u){e=L(u,"DIV",{class:!0});var m=B(e);t=L(m,"DIV",{class:!0}),B(t).forEach($),l=R(m),s=$e(m,"svg",{class:!0});var C=B(s);o=$e(C,"path",{class:!0,d:!0}),B(o).forEach($),h=$e(C,"circle",{class:!0,cx:!0,cy:!0,r:!0}),B(h).forEach($),C.forEach($),i=R(m),d&&d.l(m),m.forEach($),this.h()},h(){_(t,"class","cursor svelte-1vlmsuq"),_(o,"class","line svelte-1vlmsuq"),_(o,"d",r=`M0,0 L0,${n[5]}`),_(h,"class","icon svelte-1vlmsuq"),_(h,"cx","50%"),_(h,"cy","50%"),_(h,"r","3"),_(s,"class","main svelte-1vlmsuq"),_(e,"class",a=re(oe("cell dropout",n[0]))+" svelte-1vlmsuq"),ne(e,"active",n[4])},m(u,m){W(u,e,m),I(e,t),I(e,l),I(e,s),I(s,o),I(s,h),I(e,i),d&&d.m(e,null)},p(u,m){m&32&&r!==(r=`M0,0 L0,${u[5]}`)&&_(o,"d",r),u[3]?d||(d=il(),d.c(),d.m(e,null)):d&&(d.d(1),d=null),m&1&&a!==(a=re(oe("cell dropout",u[0]))+" svelte-1vlmsuq")&&_(e,"class",a),m&17&&ne(e,"active",u[4])},d(u){u&&$(e),d&&d.d()}}}function $s(n){let e,t,l,s,o,r,h;return{c(){e=M("div"),t=M("div"),l=G(),s=we("svg"),o=we("path"),r=we("circle"),this.h()},l(i){e=L(i,"DIV",{class:!0});var a=B(e);t=L(a,"DIV",{class:!0}),B(t).forEach($),l=R(a),s=$e(a,"svg",{class:!0});var d=B(s);o=$e(d,"path",{class:!0,d:!0}),B(o).forEach($),r=$e(d,"circle",{class:!0,cx:!0,cy:!0,r:!0}),B(r).forEach($),d.forEach($),a.forEach($),this.h()},h(){_(t,"class","cursor svelte-1vlmsuq"),_(o,"class","line line1 svelte-1vlmsuq"),_(o,"d","M0,0 L0,90%"),_(r,"class","icon svelte-1vlmsuq"),_(r,"cx","50%"),_(r,"cy","50%"),_(r,"r","3"),_(s,"class","main svelte-1vlmsuq"),_(e,"class",h=re(oe("cell activation",n[0]))+" svelte-1vlmsuq"),ne(e,"active",n[4])},m(i,a){W(i,e,a),I(e,t),I(e,l),I(e,s),I(s,o),I(s,r)},p(i,a){a&1&&h!==(h=re(oe("cell activation",i[0]))+" svelte-1vlmsuq")&&_(e,"class",h),a&17&&ne(e,"active",i[4])},d(i){i&&$(e)}}}function sl(n){let e;return{c(){e=we("path"),this.h()},l(t){e=$e(t,"path",{class:!0,d:!0}),B(e).forEach($),this.h()},h(){_(e,"class","head svelte-1vlmsuq"),_(e,"d","M0,0 Q0,-20 -30,-20")},m(t,l){W(t,e,l)},d(t){t&&$(e)}}}function ol(n){let e,t,l;return{c(){e=we("path"),t=we("text"),l=pe("Residual"),this.h()},l(s){e=$e(s,"path",{class:!0,d:!0}),B(e).forEach($),t=$e(s,"text",{x:!0,y:!0,dy:!0,dx:!0,class:!0});var o=B(t);l=ge(o,"Residual"),o.forEach($),this.h()},h(){_(e,"class","head svelte-1vlmsuq"),_(e,"d","M0,0 Q0,-20 30,-20"),_(t,"x","30"),_(t,"y","-20"),_(t,"dy","4"),_(t,"dx","4"),_(t,"class","svelte-1vlmsuq")},m(s,o){W(s,e,o),W(s,t,o),I(t,l)},d(s){s&&($(e),$(t))}}}function rl(n){let e,t,l,s;return{c(){e=we("svg"),t=we("path"),l=we("text"),s=pe("Layer Normalization"),this.h()},l(o){e=$e(o,"svg",{class:!0,width:!0});var r=B(e);t=$e(r,"path",{d:!0,class:!0}),B(t).forEach($),l=$e(r,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var h=B(l);s=ge(h,"Layer Normalization"),h.forEach($),r.forEach($),this.h()},h(){_(t,"d","M27.3536 4.35355C27.5488 4.15829 27.5488 3.84171 27.3536 3.64645L24.1716 0.46447C23.9763 0.269208 23.6597 0.269208 23.4645 0.464471C23.2692 0.659733 23.2692 0.976316 23.4645 1.17158L26.2929 4L23.4645 6.82843C23.2692 7.02369 23.2692 7.34028 23.4645 7.53554C23.6597 7.7308 23.9763 7.7308 24.1716 7.53554L27.3536 4.35355ZM27 3.5C20.3125 3.50001 15.2969 6.63952 11.5638 11.7944C7.84616 16.9278 5.39057 24.0677 3.75991 32.1346C0.498061 48.2711 0.5 68.3247 0.5 84H1.5C1.5 68.2984 1.50194 48.352 4.74009 32.3328C6.35943 24.3218 8.77884 17.3448 12.3737 12.3809C15.9531 7.4384 20.6875 4.50001 27 4.5V3.5Z"),_(t,"class","svelte-1vlmsuq"),_(l,"x","4"),_(l,"y","95"),_(l,"text-anchor","middle"),_(l,"class","svelte-1vlmsuq"),_(e,"class","guide svelte-1vlmsuq"),_(e,"width","27px"),ne(e,"active",!1)},m(o,r){W(o,e,r),I(e,t),I(e,l),I(l,s)},d(o){o&&$(e)}}}function il(n){let e,t,l,s;return{c(){e=we("svg"),t=we("path"),l=we("text"),s=pe("Dropout"),this.h()},l(o){e=$e(o,"svg",{class:!0,width:!0});var r=B(e);t=$e(r,"path",{d:!0,class:!0}),B(t).forEach($),l=$e(r,"text",{x:!0,y:!0,"text-anchor":!0,class:!0});var h=B(l);s=ge(h,"Dropout"),h.forEach($),r.forEach($),this.h()},h(){_(t,"d","M44.3186 4.46399C44.5314 4.28801 44.5613 3.97284 44.3853 3.76004L41.5175 0.292199C41.3416 0.0793953 41.0264 0.0495441 40.8136 0.225525C40.6008 0.401505 40.5709 0.716677 40.7469 0.929481L43.296 4.012L40.2135 6.56113C40.0007 6.73711 39.9709 7.05228 40.1468 7.26509C40.3228 7.47789 40.638 7.50774 40.8508 7.33176L44.3186 4.46399ZM44.0471 3.58091C38.7621 3.08034 27.8926 4.80481 18.3357 11.5838C8.74613 18.386 0.5 30.2626 0.5 50H1.5C1.5 30.5889 9.58721 19.0154 18.9143 12.3994C28.2741 5.76023 38.9045 4.0983 43.9529 4.57645L44.0471 3.58091Z"),_(t,"class","svelte-1vlmsuq"),_(l,"x","4"),_(l,"y","60"),_(l,"text-anchor","middle"),_(l,"class","svelte-1vlmsuq"),_(e,"class","guide svelte-1vlmsuq"),_(e,"width","44px"),ne(e,"active",!1)},m(o,r){W(o,e,r),I(e,t),I(e,l),I(l,s)},d(o){o&&$(e)}}}function ys(n){let e;function t(o,r){if(o[1]==="activation")return $s;if(o[1]==="dropout")return ws;if(o[1]==="ln")return ks;if(o[1]==="residual-start")return bs;if(o[1]==="residual-end")return _s}let l=t(n),s=l&&l(n);return{c(){s&&s.c(),e=lt()},l(o){s&&s.l(o),e=lt()},m(o,r){s&&s.m(o,r),W(o,e,r)},p(o,[r]){l===(l=t(o))&&s?s.p(o,r):(s&&s.d(1),s=l&&l(o),s&&(s.c(),s.m(e.parentNode,e)))},i:qe,o:qe,d(o){o&&$(e),s&&s.d(o)}}}function Es(n,e,t){let l;be(n,Vt,a=>t(5,l=a));let{className:s=void 0}=e,{type:o=void 0}=e,{head:r=!1}=e,{tail:h=!1}=e,{active:i=!1}=e;return n.$$set=a=>{"className"in a&&t(0,s=a.className),"type"in a&&t(1,o=a.type),"head"in a&&t(2,r=a.head),"tail"in a&&t(3,h=a.tail),"active"in a&&t(4,i=a.active)},[s,o,r,h,i,l]}class pt extends Me{constructor(e){super(),Le(this,e,Es,ys,Ne,{className:0,type:1,head:2,tail:3,active:4})}}function al(n,e,t){const l=n.slice();return l[6]=e[t],l[8]=t,l}function cl(n){let e,t,l,s;return{c(){e=M("div"),t=M("div"),s=G(),this.h()},l(o){e=L(o,"DIV",{class:!0});var r=B(e);t=L(r,"DIV",{class:!0}),B(t).forEach($),s=R(r),r.forEach($),this.h()},h(){_(t,"class",l=re(oe("vector shrink-0 bg-blue-200",{"last-token":n[8]===n[3].length-1}))+" svelte-nx91yw"),_(e,"class","cell svelte-nx91yw"),ne(e,"last",n[8]===n[3].length-1)},m(o,r){W(o,e,r),I(e,t),I(e,s)},p(o,r){r&8&&l!==(l=re(oe("vector shrink-0 bg-blue-200",{"last-token":o[8]===o[3].length-1}))+" svelte-nx91yw")&&_(t,"class",l),r&8&&ne(e,"last",o[8]===o[3].length-1)},d(o){o&&$(e)}}}function Is(n){let e,t,l,s,o,r,h,i,a,d,u=n[2].layer_num-1+"",m,C,N,D,q="Transformer<br/>Blocks",O,y,A,T,H,P="",Q,f,c,v=ce(n[3]),p=[];for(let k=0;k<v.length;k+=1)p[k]=cl(al(n,v,k));return{c(){e=M("div"),t=M("div"),l=G(),s=M("div"),o=M("div"),r=M("div"),h=we("svg"),i=we("path"),a=G(),d=M("div"),m=pe(u),C=pe(" more"),N=M("br"),D=M("span"),D.innerHTML=q,O=M("br"),y=pe("go here."),A=G();for(let k=0;k<p.length;k+=1)p[k].c();T=G(),H=M("div"),H.innerHTML=P,this.h()},l(k){e=L(k,"DIV",{class:!0,role:!0});var V=B(e);t=L(V,"DIV",{class:!0}),B(t).forEach($),l=R(V),s=L(V,"DIV",{class:!0});var E=B(s);o=L(E,"DIV",{class:!0});var b=B(o);r=L(b,"DIV",{class:!0});var g=B(r);h=$e(g,"svg",{class:!0,width:!0,height:!0,viewBox:!0,fill:!0});var S=B(h);i=$e(S,"path",{d:!0,fill:!0}),B(i).forEach($),S.forEach($),a=R(g),d=L(g,"DIV",{class:!0});var w=B(d);m=ge(w,u),C=ge(w," more"),N=L(w,"BR",{}),D=L(w,"SPAN",{class:!0,"data-svelte-h":!0}),ye(D)!=="svelte-jj13a6"&&(D.innerHTML=q),O=L(w,"BR",{}),y=ge(w,"go here."),w.forEach($),g.forEach($),A=R(b);for(let z=0;z<p.length;z+=1)p[z].l(b);b.forEach($),T=R(E),H=L(E,"DIV",{class:!0,"data-svelte-h":!0}),ye(H)!=="svelte-shkdve"&&(H.innerHTML=P),E.forEach($),V.forEach($),this.h()},h(){_(t,"class","title"),_(i,"d","M4.01159 29.4026C4.23396 29.5664 4.54695 29.5188 4.71068 29.2965L7.37882 25.6728C7.54255 25.4504 7.49501 25.1374 7.27264 24.9737C7.05028 24.81 6.73728 24.8575 6.57355 25.0799L4.20188 28.3009L0.980829 25.9292C0.758462 25.7655 0.445469 25.813 0.281739 26.0354C0.118009 26.2578 0.165543 26.5708 0.387911 26.7345L4.01159 29.4026ZM4.80238 28.9249C4.10481 24.3318 4.43981 17.4539 7.67418 11.7465C10.885 6.08071 16.9895 1.5 28 1.5V0.5C16.655 0.5 10.2048 5.25263 6.80417 11.2535C3.42706 17.2128 3.09382 24.3349 3.81372 29.0751L4.80238 28.9249Z"),_(i,"fill","#D1D5DB"),_(h,"class","arrow"),_(h,"width","28"),_(h,"height","30"),_(h,"viewBox","0 0 28 30"),_(h,"fill","none"),_(D,"class","highlight svelte-nx91yw"),_(d,"class","text svelte-nx91yw"),ne(d,"active",n[1]),_(r,"class","guide flex items-end gap-1 svelte-nx91yw"),_(o,"class","column final relative svelte-nx91yw"),_(H,"class","second-column svelte-nx91yw"),_(s,"class","content svelte-nx91yw"),_(e,"class",Q=re(oe("transformer-blocks",n[0]))+" svelte-nx91yw"),_(e,"role","group")},m(k,V){W(k,e,V),I(e,t),I(e,l),I(e,s),I(s,o),I(o,r),I(r,h),I(h,i),I(r,a),I(r,d),I(d,m),I(d,C),I(d,N),I(d,D),I(d,O),I(d,y),I(o,A);for(let E=0;E<p.length;E+=1)p[E]&&p[E].m(o,null);I(s,T),I(s,H),f||(c=[_e(e,"mouseenter",n[4]),_e(e,"mouseleave",n[5])],f=!0)},p(k,[V]){if(V&4&&u!==(u=k[2].layer_num-1+"")&&Se(m,u),V&2&&ne(d,"active",k[1]),V&8){v=ce(k[3]);let E;for(E=0;E<v.length;E+=1){const b=al(k,v,E);p[E]?p[E].p(b,V):(p[E]=cl(b),p[E].c(),p[E].m(o,null))}for(;E<p.length;E+=1)p[E].d(1);p.length=v.length}V&1&&Q!==(Q=re(oe("transformer-blocks",k[0]))+" svelte-nx91yw")&&_(e,"class",Q)},i:qe,o:qe,d(k){k&&$(e),De(p,k),f=!1,Pe(c)}}}function Ds(n,e,t){let l,s,o;be(n,ht,a=>t(1,l=a)),be(n,kt,a=>t(2,s=a)),be(n,Ze,a=>t(3,o=a));let{className:r=void 0}=e;const h=()=>{ht.set(!0)},i=()=>{ht.set(!1)};return n.$$set=a=>{"className"in a&&t(0,r=a.className)},[r,l,s,o,h,i]}class Cs extends Me{constructor(e){super(),Le(this,e,Ds,Is,Ne,{className:0})}}function Vs(n){let e,t,l,s;return{c(){e=M("div"),t=we("svg"),l=we("g"),s=we("g"),this.h()},l(o){e=L(o,"DIV",{class:!0});var r=B(e);t=$e(r,"svg",{class:!0});var h=B(t);l=$e(h,"g",{class:!0}),B(l).forEach($),s=$e(h,"g",{class:!0}),B(s).forEach($),h.forEach($),r.forEach($),this.h()},h(){_(l,"class","bars"),_(s,"class","bar-labels"),_(t,"class","h-full w-full"),_(e,"class","content-box probability grow svelte-8s3yoj")},m(o,r){W(o,e,r),I(e,t),I(t,l),I(t,s),n[5](t)},p:qe,i:qe,o:qe,d(o){o&&$(e),n[5](null)}}}const ul=4;let Ss=1;function qs(n,e,t){let l,s;be(n,wt,D=>t(6,l=D)),be(n,ut,D=>t(4,s=D));const{theme:o}=rt(it);let{rowHeight:r}=e,{rowGap:h}=e,{hoveredIndex:i=null}=e,a,d=o.colors.gray[300],u=o.colors.blue[500],m=()=>{const D=s==null?void 0:s.prediction,q=s==null?void 0:s.sampled,O=Je(a);let y=Nn().domain([0,Hn(D,A=>A.adjustedProbability)]).range([0,(a==null?void 0:a.clientWidth)-ct*3]);O.select("g.bars").selectAll("rect").data(D).join("rect").attr("x",0).attr("y",(A,T)=>T*r+T*h+r/2-ul/2).attr("height",ul).attr("width",A=>y(A.adjustedProbability)).attr("rx",1).attr("ry",1).attr("fill",(A,T)=>T===i?u:(q==null?void 0:q.rank)===T?gt:d).on("mouseenter",function(A,T){t(1,i=T.rank),Je(this).style("cursor","pointer")}).on("mouseleave",()=>t(1,i=null)).transition().ease(Dn).duration(500).attr("width",A=>y(A.adjustedProbability)),O.select("g.bar-labels").selectAll("text").data(D).join("text").attr("fill",(A,T)=>T===i?u:(q==null?void 0:q.rank)===T?gt:d).on("mouseenter",function(A,T){t(1,i=T.rank),Je(this).style("cursor","pointer")}).on("mouseleave",()=>{t(1,i=null)}).attr("x",A=>.4*ct+y(A.adjustedProbability)).attr("y",(A,T)=>T*r+T*h).attr("dy",r/2+3).attr("text-anchor","start").style("font-size","0.75rem").transition().duration(500).tween("text",function(A){const T=Je(this),H=Cn(T.text().replace("%",""),A.adjustedProbability*100);return function(P){T.text(H(P).toFixed(Ss)+"%")}})};dt(()=>{m()});const C=()=>{if(!a)return;const D=Je(a);D.selectAll("g.bars rect").attr("fill",(q,O)=>O===i?u:(l==null?void 0:l.rank)===O?gt:d),D.selectAll("g.bar-labels text").attr("fill",(q,O)=>O===i?u:(l==null?void 0:l.rank)===O?gt:d)};function N(D){Ue[D?"unshift":"push"](()=>{a=D,t(0,a)})}return n.$$set=D=>{"rowHeight"in D&&t(2,r=D.rowHeight),"rowGap"in D&&t(3,h=D.rowGap),"hoveredIndex"in D&&t(1,i=D.hoveredIndex)},n.$$.update=()=>{n.$$.dirty&17&&s&&a&&m(),n.$$.dirty&2&&i!==void 0&&C()},[a,i,r,h,s,N]}class As extends Me{constructor(e){super(),Le(this,e,qs,Vs,Ne,{rowHeight:2,rowGap:3,hoveredIndex:1})}}function fl(n,e,t){const l=n.slice();return l[30]=e[t],l[32]=t,l}function hl(n,e,t){const l=n.slice();return l[33]=e[t],l[32]=t,l}function dl(n,e,t){const l=n.slice();return l[35]=e[t],l[32]=t,l}function Ns(n){let e,t=n[7][n[32]]+"",l,s;return{c(){e=pe("Token ID: "),l=pe(t),s=G()},l(o){e=ge(o,"Token ID: "),l=ge(o,t),s=R(o)},m(o,r){W(o,e,r),W(o,l,r),W(o,s,r)},p(o,r){r[0]&128&&t!==(t=o[7][o[32]]+"")&&Se(l,t)},d(o){o&&($(e),$(l),$(s))}}}function pl(n){let e,t=n[35].token+"",l,s,o,r,h,i;function a(){return n[18](n[32])}return o=new et({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Ns]},$$scope:{ctx:n}}}),{c(){e=M("div"),l=pe(t),s=G(),ue(o.$$.fragment),this.h()},l(d){e=L(d,"DIV",{role:!0,class:!0});var u=B(e);l=ge(u,t),u.forEach($),s=R(d),fe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box svelte-oxhaat"),ne(e,"highlight",n[32]===n[3]),ne(e,"sample_highlight",n[8]===n[32]),ne(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,u){W(d,e,u),I(e,l),W(d,s,u),he(o,d,u),r=!0,h||(i=[_e(e,"mouseenter",a),_e(e,"mouseleave",n[19])],h=!0)},p(d,u){var C;n=d,(!r||u[0]&4)&&t!==(t=n[35].token+"")&&Se(l,t),(!r||u[0]&8)&&ne(e,"highlight",n[32]===n[3]),(!r||u[0]&256)&&ne(e,"sample_highlight",n[8]===n[32]),(!r||u[0]&512)&&ne(e,"final_token_highlight",((C=n[9])==null?void 0:C.rank)===n[32]);const m={};u[0]&128|u[1]&64&&(m.$$scope={dirty:u,ctx:n}),o.$set(m)},i(d){r||(X(o.$$.fragment,d),r=!0)},o(d){te(o.$$.fragment,d),r=!1},d(d){d&&($(e),$(s)),de(o,d),h=!1,Pe(i)}}}function gl(n){let e,t='<div class="title-box token-string !justify-end svelte-oxhaat"><div class="title-text svelte-oxhaat">Tokens</div></div> <div class="title-box logits svelte-oxhaat"><div class="title-text svelte-oxhaat">Logits</div></div> <div class="title-box exponents svelte-oxhaat"><div class="title-text svelte-oxhaat">Exponents</div></div> <div class="title-box probability svelte-oxhaat"><div class="title-text svelte-oxhaat">Probability</div></div>';return{c(){e=M("div"),e.innerHTML=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-16l107t"&&(e.innerHTML=t),this.h()},h(){_(e,"class","softmax-subtitle softmax-detail flex text-center text-xs opacity-0 svelte-oxhaat")},m(l,s){W(l,e,s)},d(l){l&&$(e)}}}function ml(n){let e,t,l,s,o=ce(n[6]),r=[];for(let u=0;u<o.length;u+=1)r[u]=_l(hl(n,o,u));const h=u=>te(r[u],1,1,()=>{r[u]=null});let i=ce(n[5]),a=[];for(let u=0;u<i.length;u+=1)a[u]=bl(fl(n,i,u));const d=u=>te(a[u],1,1,()=>{a[u]=null});return{c(){e=M("div");for(let u=0;u<r.length;u+=1)r[u].c();t=G(),l=M("div");for(let u=0;u<a.length;u+=1)a[u].c();this.h()},l(u){e=L(u,"DIV",{class:!0});var m=B(e);for(let N=0;N<r.length;N+=1)r[N].l(m);m.forEach($),t=R(u),l=L(u,"DIV",{class:!0});var C=B(l);for(let N=0;N<a.length;N+=1)a[N].l(C);C.forEach($),this.h()},h(){_(e,"class","content-box vector-box logits ml-2 svelte-oxhaat"),_(l,"class","content-box vector-box exponents svelte-oxhaat")},m(u,m){W(u,e,m);for(let C=0;C<r.length;C+=1)r[C]&&r[C].m(e,null);W(u,t,m),W(u,l,m);for(let C=0;C<a.length;C+=1)a[C]&&a[C].m(l,null);s=!0},p(u,m){if(m[0]&1864){o=ce(u[6]);let C;for(C=0;C<o.length;C+=1){const N=hl(u,o,C);r[C]?(r[C].p(N,m),X(r[C],1)):(r[C]=_l(N),r[C].c(),X(r[C],1),r[C].m(e,null))}for(Be(),C=o.length;C<r.length;C+=1)h(C);ze()}if(m[0]&872){i=ce(u[5]);let C;for(C=0;C<i.length;C+=1){const N=fl(u,i,C);a[C]?(a[C].p(N,m),X(a[C],1)):(a[C]=bl(N),a[C].c(),X(a[C],1),a[C].m(l,null))}for(Be(),C=i.length;C<a.length;C+=1)d(C);ze()}},i(u){if(!s){for(let m=0;m<o.length;m+=1)X(r[m]);for(let m=0;m<i.length;m+=1)X(a[m]);s=!0}},o(u){r=r.filter(Boolean);for(let m=0;m<r.length;m+=1)te(r[m]);a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)te(a[m]);s=!1},d(u){u&&($(e),$(t),$(l)),De(r,u),De(a,u)}}}function vl(n){let e,t=n[33].toFixed(2)+"",l,s,o,r,h,i;function a(){return n[20](n[32])}return o=new et({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Ms]},$$scope:{ctx:n}}}),{c(){e=M("div"),l=pe(t),s=G(),ue(o.$$.fragment),this.h()},l(d){e=L(d,"DIV",{role:!0,class:!0});var u=B(e);l=ge(u,t),u.forEach($),s=R(d),fe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),ne(e,"highlight",n[32]===n[3]),ne(e,"sample_highlight",n[8]===n[32]),ne(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,u){W(d,e,u),I(e,l),W(d,s,u),he(o,d,u),r=!0,h||(i=[_e(e,"mouseenter",a),_e(e,"mouseleave",n[21])],h=!0)},p(d,u){var C;n=d,(!r||u[0]&64)&&t!==(t=n[33].toFixed(2)+"")&&Se(l,t),(!r||u[0]&8)&&ne(e,"highlight",n[32]===n[3]),(!r||u[0]&256)&&ne(e,"sample_highlight",n[8]===n[32]),(!r||u[0]&512)&&ne(e,"final_token_highlight",((C=n[9])==null?void 0:C.rank)===n[32]);const m={};u[0]&1088|u[1]&64&&(m.$$scope={dirty:u,ctx:n}),o.$set(m)},i(d){r||(X(o.$$.fragment,d),r=!0)},o(d){te(o.$$.fragment,d),r=!1},d(d){d&&($(e),$(s)),de(o,d),h=!1,Pe(i)}}}function Ms(n){let e=(n[33]*n[10]).toFixed(2)+"",t,l,s,o,r=n[33].toFixed(2)+"",h,i;return{c(){t=pe(e),l=pe("  "),s=pe(n[10]),o=pe(" = "),h=pe(r),i=G()},l(a){t=ge(a,e),l=ge(a,"  "),s=ge(a,n[10]),o=ge(a," = "),h=ge(a,r),i=R(a)},m(a,d){W(a,t,d),W(a,l,d),W(a,s,d),W(a,o,d),W(a,h,d),W(a,i,d)},p(a,d){d[0]&1088&&e!==(e=(a[33]*a[10]).toFixed(2)+"")&&Se(t,e),d[0]&1024&&Se(s,a[10]),d[0]&64&&r!==(r=a[33].toFixed(2)+"")&&Se(h,r)},d(a){a&&($(t),$(l),$(s),$(o),$(h),$(i))}}}function _l(n){let e,t,l=n[33]!==void 0&&vl(n);return{c(){l&&l.c(),e=lt()},l(s){l&&l.l(s),e=lt()},m(s,o){l&&l.m(s,o),W(s,e,o),t=!0},p(s,o){s[33]!==void 0?l?(l.p(s,o),o[0]&64&&X(l,1)):(l=vl(s),l.c(),X(l,1),l.m(e.parentNode,e)):l&&(Be(),te(l,1,1,()=>{l=null}),ze())},i(s){t||(X(l),t=!0)},o(s){te(l),t=!1},d(s){s&&$(e),l&&l.d(s)}}}function Ls(n){let e,t=n[6][n[32]].toFixed(2)+"",l,s,o=n[30].toFixed(2)+"",r,h;return{c(){e=pe("exp("),l=pe(t),s=pe(") = "),r=pe(o),h=G()},l(i){e=ge(i,"exp("),l=ge(i,t),s=ge(i,") = "),r=ge(i,o),h=R(i)},m(i,a){W(i,e,a),W(i,l,a),W(i,s,a),W(i,r,a),W(i,h,a)},p(i,a){a[0]&64&&t!==(t=i[6][i[32]].toFixed(2)+"")&&Se(l,t),a[0]&32&&o!==(o=i[30].toFixed(2)+"")&&Se(r,o)},d(i){i&&($(e),$(l),$(s),$(r),$(h))}}}function bl(n){let e,t=n[30].toExponential(2)+"",l,s,o,r,h,i;function a(){return n[22](n[32])}return o=new et({props:{class:"text-xs",placement:"left",type:"light",$$slots:{default:[Ls]},$$scope:{ctx:n}}}),{c(){e=M("div"),l=pe(t),s=G(),ue(o.$$.fragment),this.h()},l(d){e=L(d,"DIV",{role:!0,class:!0});var u=B(e);l=ge(u,t),u.forEach($),s=R(d),fe(o.$$.fragment,d),this.h()},h(){var d;_(e,"role","group"),_(e,"class","text-box text-center svelte-oxhaat"),ne(e,"highlight",n[32]===n[3]),ne(e,"sample_highlight",n[8]===n[32]),ne(e,"final_token_highlight",((d=n[9])==null?void 0:d.rank)===n[32])},m(d,u){W(d,e,u),I(e,l),W(d,s,u),he(o,d,u),r=!0,h||(i=[_e(e,"mouseenter",a),_e(e,"mouseleave",n[23])],h=!0)},p(d,u){var C;n=d,(!r||u[0]&32)&&t!==(t=n[30].toExponential(2)+"")&&Se(l,t),(!r||u[0]&8)&&ne(e,"highlight",n[32]===n[3]),(!r||u[0]&256)&&ne(e,"sample_highlight",n[8]===n[32]),(!r||u[0]&512)&&ne(e,"final_token_highlight",((C=n[9])==null?void 0:C.rank)===n[32]);const m={};u[0]&96|u[1]&64&&(m.$$scope={dirty:u,ctx:n}),o.$set(m)},i(d){r||(X(o.$$.fragment,d),r=!0)},o(d){te(o.$$.fragment,d),r=!1},d(d){d&&($(e),$(s)),de(o,d),h=!1,Pe(i)}}}function Bs(n){let e,t,l="<div>Probabilities</div>",s,o,r,h,i,a,d,u,m,C,N,D,q,O,y,A,T,H,P,Q,f=ce(n[2]),c=[];for(let b=0;b<f.length;b+=1)c[b]=pl(dl(n,f,b));const v=b=>te(c[b],1,1,()=>{c[b]=null});let p=n[1]&&gl(),k=n[1]&&ml(n);function V(b){n[24](b)}let E={rowGap:n[13],rowHeight:n[12]};return n[3]!==void 0&&(E.hoveredIndex=n[3]),y=new As({props:E}),Ue.push(()=>mn(y,"hoveredIndex",V)),{c(){e=M("div"),t=M("div"),t.innerHTML=l,s=G(),o=M("div"),r=M("div"),h=G(),i=M("div"),a=M("div");for(let b=0;b<c.length;b+=1)c[b].c();d=G(),u=M("div"),m=G(),C=M("div"),p&&p.c(),N=G(),D=M("div"),q=M("div"),k&&k.c(),O=G(),ue(y.$$.fragment),this.h()},l(b){e=L(b,"DIV",{class:!0,role:!0,tabindex:!0});var g=B(e);t=L(g,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),ye(t)!=="svelte-11ugyn5"&&(t.innerHTML=l),s=R(g),o=L(g,"DIV",{class:!0,style:!0});var S=B(o);r=L(S,"DIV",{class:!0}),B(r).forEach($),h=R(S),i=L(S,"DIV",{class:!0});var w=B(i);a=L(w,"DIV",{class:!0});var z=B(a);for(let se=0;se<c.length;se+=1)c[se].l(z);z.forEach($),d=R(w),u=L(w,"DIV",{class:!0}),B(u).forEach($),w.forEach($),m=R(S),C=L(S,"DIV",{class:!0});var U=B(C);p&&p.l(U),N=R(U),D=L(U,"DIV",{class:!0});var Z=B(D);q=L(Z,"DIV",{class:!0});var ee=B(q);k&&k.l(ee),ee.forEach($),O=R(Z),fe(y.$$.fragment,Z),Z.forEach($),U.forEach($),S.forEach($),g.forEach($),this.h()},h(){_(t,"class","title expandable"),_(t,"role","group"),_(r,"class","bounding softmax-bounding svelte-oxhaat"),ne(r,"active",n[4]&&!n[1]),_(a,"class","content-box token-string svelte-oxhaat"),_(u,"class","vector vocab opacity-1 w-0"),_(i,"class","first-column relative flex justify-end"),_(q,"class","softmax-detail expandable flex gap-2 opacity-0"),_(D,"class","content-row flex gap-2"),_(C,"class","resize-watch second-column flex flex-col svelte-oxhaat"),_(o,"class","content relative svelte-oxhaat"),_(o,"style",`--softmax-row-height: ${n[12]}px;--softmax-row-gap: ${n[13]}px`),_(e,"class",T=re(oe("softmax",n[0]))+" svelte-oxhaat"),_(e,"role","button"),_(e,"tabindex","0")},m(b,g){W(b,e,g),I(e,t),I(e,s),I(e,o),I(o,r),I(o,h),I(o,i),I(i,a);for(let S=0;S<c.length;S+=1)c[S]&&c[S].m(a,null);I(i,d),I(i,u),I(o,m),I(o,C),p&&p.m(C,null),I(C,N),I(C,D),I(D,q),k&&k.m(q,null),I(D,O),he(y,D,null),H=!0,P||(Q=[_e(t,"mouseenter",n[14]),_e(t,"mouseleave",n[15]),_e(e,"click",n[11]),_e(e,"keydown",n[11])],P=!0)},p(b,g){if((!H||g[0]&18)&&ne(r,"active",b[4]&&!b[1]),g[0]&908){f=ce(b[2]);let w;for(w=0;w<f.length;w+=1){const z=dl(b,f,w);c[w]?(c[w].p(z,g),X(c[w],1)):(c[w]=pl(z),c[w].c(),X(c[w],1),c[w].m(a,null))}for(Be(),w=f.length;w<c.length;w+=1)v(w);ze()}b[1]?p||(p=gl(),p.c(),p.m(C,N)):p&&(p.d(1),p=null),b[1]?k?(k.p(b,g),g[0]&2&&X(k,1)):(k=ml(b),k.c(),X(k,1),k.m(q,null)):k&&(Be(),te(k,1,1,()=>{k=null}),ze());const S={};!A&&g[0]&8&&(A=!0,S.hoveredIndex=b[3],pn(()=>A=!1)),y.$set(S),(!H||g[0]&1&&T!==(T=re(oe("softmax",b[0]))+" svelte-oxhaat"))&&_(e,"class",T)},i(b){if(!H){for(let g=0;g<f.length;g+=1)X(c[g]);X(k),X(y.$$.fragment,b),H=!0}},o(b){c=c.filter(Boolean);for(let g=0;g<c.length;g+=1)te(c[g]);te(k),te(y.$$.fragment,b),H=!1},d(b){b&&$(e),De(c,b),p&&p.d(),k&&k.d(),de(y),P=!1,Pe(Q)}}}function zs(n,e,t){let l,s,o,r,h,i,a,d,u;be(n,ut,g=>t(16,h=g)),be(n,Re,g=>t(17,i=g)),be(n,vn,g=>t(8,a=g)),be(n,wt,g=>t(9,d=g)),be(n,St,g=>t(10,u=g));let{className:m=void 0}=e;rt(it),bt("block-id","softmax");const C=_t("block-id");let N=!1;const D=()=>{N?(Re.set({id:null}),y()):(Re.set({id:C}),O())};let q;const O=async()=>{q=tt.Flip.getState(".softmax .softmax-detail.expandable"),t(1,N=!0),await st();const g=document.getElementById("main");g.style.justifyContent="end",await st(),tt.Flip.from(q,{duration:1,ease:"power2.inOut"}),ot.to(".softmax-detail",{opacity:1,duration:.5,delay:.5})},y=async()=>{q=tt.Flip.getState(".softmax .softmax-detail.expandable"),t(1,N=!1),await st(),await tt.Flip.from(q,{duration:.5,ease:"power2.inOut"}),ot.to(".softmax-detail",{opacity:0,duration:.5}),await st();const g=document.getElementById("main");g.style.justifyContent="start"};let A=ct*1.2,T=.5*ct,H=null,P=!1;function Q(){t(4,P=!0)}function f(){t(4,P=!1)}const c=g=>t(3,H=g),v=()=>t(3,H=null),p=g=>t(3,H=g),k=()=>t(3,H=null),V=g=>t(3,H=g),E=()=>t(3,H=null);function b(g){H=g,t(3,H)}return n.$$set=g=>{"className"in g&&t(0,m=g.className)},n.$$.update=()=>{n.$$.dirty[0]&131074&&i.id!==C&&N&&(t(1,N=!1),y()),n.$$.dirty[0]&65536&&t(2,l=(h==null?void 0:h.prediction)||[]),n.$$.dirty[0]&4&&t(7,s=l==null?void 0:l.map(g=>g.tokenId)),n.$$.dirty[0]&4&&t(6,o=(l==null?void 0:l.map(g=>g.adjustedLogit))||[]),n.$$.dirty[0]&4&&t(5,r=(l==null?void 0:l.map(g=>g.adjustedExp))||[])},[m,N,l,H,P,r,o,s,a,d,u,D,A,T,Q,f,h,i,c,v,p,k,V,E,b]}class Ts extends Me{constructor(e){super(),Le(this,e,zs,Bs,Ne,{className:0},null,[-1,-1])}}var Hs=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,Et=Math.ceil,Oe=Math.floor,He="[BigNumber Error] ",kl=He+"Number primitive has more than 15 significant digits: ",Ge=1e14,me=14,It=9007199254740991,Dt=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Ke=1e7,Ae=1e9;function hn(n){var e,t,l,s=y.prototype={constructor:y,toString:null,valueOf:null},o=new y(1),r=20,h=4,i=-7,a=21,d=-1e7,u=1e7,m=!1,C=1,N=0,D={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"",suffix:""},q="0123456789abcdefghijklmnopqrstuvwxyz",O=!0;function y(f,c){var v,p,k,V,E,b,g,S,w=this;if(!(w instanceof y))return new y(f,c);if(c==null){if(f&&f._isBigNumber===!0){w.s=f.s,!f.c||f.e>u?w.c=w.e=null:f.e<d?w.c=[w.e=0]:(w.e=f.e,w.c=f.c.slice());return}if((b=typeof f=="number")&&f*0==0){if(w.s=1/f<0?(f=-f,-1):1,f===~~f){for(V=0,E=f;E>=10;E/=10,V++);V>u?w.c=w.e=null:(w.e=V,w.c=[f]);return}S=String(f)}else{if(!Hs.test(S=String(f)))return l(w,S,b);w.s=S.charCodeAt(0)==45?(S=S.slice(1),-1):1}(V=S.indexOf("."))>-1&&(S=S.replace(".","")),(E=S.search(/e/i))>0?(V<0&&(V=E),V+=+S.slice(E+1),S=S.substring(0,E)):V<0&&(V=S.length)}else{if(Ce(c,2,q.length,"Base"),c==10&&O)return w=new y(f),P(w,r+w.e+1,h);if(S=String(f),b=typeof f=="number"){if(f*0!=0)return l(w,S,b,c);if(w.s=1/f<0?(S=S.slice(1),-1):1,y.DEBUG&&S.replace(/^0\.0*|\./,"").length>15)throw Error(kl+f)}else w.s=S.charCodeAt(0)===45?(S=S.slice(1),-1):1;for(v=q.slice(0,c),V=E=0,g=S.length;E<g;E++)if(v.indexOf(p=S.charAt(E))<0){if(p=="."){if(E>V){V=g;continue}}else if(!k&&(S==S.toUpperCase()&&(S=S.toLowerCase())||S==S.toLowerCase()&&(S=S.toUpperCase()))){k=!0,E=-1,V=0;continue}return l(w,String(f),b,c)}b=!1,S=t(S,c,10,w.s),(V=S.indexOf("."))>-1?S=S.replace(".",""):V=S.length}for(E=0;S.charCodeAt(E)===48;E++);for(g=S.length;S.charCodeAt(--g)===48;);if(S=S.slice(E,++g)){if(g-=E,b&&y.DEBUG&&g>15&&(f>It||f!==Oe(f)))throw Error(kl+w.s*f);if((V=V-E-1)>u)w.c=w.e=null;else if(V<d)w.c=[w.e=0];else{if(w.e=V,w.c=[],E=(V+1)%me,V<0&&(E+=me),E<g){for(E&&w.c.push(+S.slice(0,E)),g-=me;E<g;)w.c.push(+S.slice(E,E+=me));E=me-(S=S.slice(E)).length}else E-=g;for(;E--;S+="0");w.c.push(+S)}}else w.c=[w.e=0]}y.clone=hn,y.ROUND_UP=0,y.ROUND_DOWN=1,y.ROUND_CEIL=2,y.ROUND_FLOOR=3,y.ROUND_HALF_UP=4,y.ROUND_HALF_DOWN=5,y.ROUND_HALF_EVEN=6,y.ROUND_HALF_CEIL=7,y.ROUND_HALF_FLOOR=8,y.EUCLID=9,y.config=y.set=function(f){var c,v;if(f!=null)if(typeof f=="object"){if(f.hasOwnProperty(c="DECIMAL_PLACES")&&(v=f[c],Ce(v,0,Ae,c),r=v),f.hasOwnProperty(c="ROUNDING_MODE")&&(v=f[c],Ce(v,0,8,c),h=v),f.hasOwnProperty(c="EXPONENTIAL_AT")&&(v=f[c],v&&v.pop?(Ce(v[0],-Ae,0,c),Ce(v[1],0,Ae,c),i=v[0],a=v[1]):(Ce(v,-Ae,Ae,c),i=-(a=v<0?-v:v))),f.hasOwnProperty(c="RANGE"))if(v=f[c],v&&v.pop)Ce(v[0],-Ae,-1,c),Ce(v[1],1,Ae,c),d=v[0],u=v[1];else if(Ce(v,-Ae,Ae,c),v)d=-(u=v<0?-v:v);else throw Error(He+c+" cannot be zero: "+v);if(f.hasOwnProperty(c="CRYPTO"))if(v=f[c],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))m=v;else throw m=!v,Error(He+"crypto unavailable");else m=v;else throw Error(He+c+" not true or false: "+v);if(f.hasOwnProperty(c="MODULO_MODE")&&(v=f[c],Ce(v,0,9,c),C=v),f.hasOwnProperty(c="POW_PRECISION")&&(v=f[c],Ce(v,0,Ae,c),N=v),f.hasOwnProperty(c="FORMAT"))if(v=f[c],typeof v=="object")D=v;else throw Error(He+c+" not an object: "+v);if(f.hasOwnProperty(c="ALPHABET"))if(v=f[c],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))O=v.slice(0,10)=="0123456789",q=v;else throw Error(He+c+" invalid: "+v)}else throw Error(He+"Object expected: "+f);return{DECIMAL_PLACES:r,ROUNDING_MODE:h,EXPONENTIAL_AT:[i,a],RANGE:[d,u],CRYPTO:m,MODULO_MODE:C,POW_PRECISION:N,FORMAT:D,ALPHABET:q}},y.isBigNumber=function(f){if(!f||f._isBigNumber!==!0)return!1;if(!y.DEBUG)return!0;var c,v,p=f.c,k=f.e,V=f.s;e:if({}.toString.call(p)=="[object Array]"){if((V===1||V===-1)&&k>=-Ae&&k<=Ae&&k===Oe(k)){if(p[0]===0){if(k===0&&p.length===1)return!0;break e}if(c=(k+1)%me,c<1&&(c+=me),String(p[0]).length==c){for(c=0;c<p.length;c++)if(v=p[c],v<0||v>=Ge||v!==Oe(v))break e;if(v!==0)return!0}}}else if(p===null&&k===null&&(V===null||V===1||V===-1))return!0;throw Error(He+"Invalid BigNumber: "+f)},y.maximum=y.max=function(){return T(arguments,-1)},y.minimum=y.min=function(){return T(arguments,1)},y.random=function(){var f=9007199254740992,c=Math.random()*f&2097151?function(){return Oe(Math.random()*f)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var p,k,V,E,b,g=0,S=[],w=new y(o);if(v==null?v=r:Ce(v,0,Ae),E=Et(v/me),m)if(crypto.getRandomValues){for(p=crypto.getRandomValues(new Uint32Array(E*=2));g<E;)b=p[g]*131072+(p[g+1]>>>11),b>=9e15?(k=crypto.getRandomValues(new Uint32Array(2)),p[g]=k[0],p[g+1]=k[1]):(S.push(b%1e14),g+=2);g=E/2}else if(crypto.randomBytes){for(p=crypto.randomBytes(E*=7);g<E;)b=(p[g]&31)*281474976710656+p[g+1]*1099511627776+p[g+2]*4294967296+p[g+3]*16777216+(p[g+4]<<16)+(p[g+5]<<8)+p[g+6],b>=9e15?crypto.randomBytes(7).copy(p,g):(S.push(b%1e14),g+=7);g=E/7}else throw m=!1,Error(He+"crypto unavailable");if(!m)for(;g<E;)b=c(),b<9e15&&(S[g++]=b%1e14);for(E=S[--g],v%=me,E&&v&&(b=Dt[me-v],S[g]=Oe(E/b)*b);S[g]===0;S.pop(),g--);if(g<0)S=[V=0];else{for(V=-1;S[0]===0;S.splice(0,1),V-=me);for(g=1,b=S[0];b>=10;b/=10,g++);g<me&&(V-=me-g)}return w.e=V,w.c=S,w}}(),y.sum=function(){for(var f=1,c=arguments,v=new y(c[0]);f<c.length;)v=v.plus(c[f++]);return v},t=function(){var f="0123456789";function c(v,p,k,V){for(var E,b=[0],g,S=0,w=v.length;S<w;){for(g=b.length;g--;b[g]*=p);for(b[0]+=V.indexOf(v.charAt(S++)),E=0;E<b.length;E++)b[E]>k-1&&(b[E+1]==null&&(b[E+1]=0),b[E+1]+=b[E]/k|0,b[E]%=k)}return b.reverse()}return function(v,p,k,V,E){var b,g,S,w,z,U,Z,ee,se=v.indexOf("."),F=r,x=h;for(se>=0&&(w=N,N=0,v=v.replace(".",""),ee=new y(p),U=ee.pow(v.length-se),N=w,ee.c=c(We(xe(U.c),U.e,"0"),10,k,f),ee.e=ee.c.length),Z=c(v,p,k,E?(b=q,f):(b=f,q)),S=w=Z.length;Z[--w]==0;Z.pop());if(!Z[0])return b.charAt(0);if(se<0?--S:(U.c=Z,U.e=S,U.s=V,U=e(U,ee,F,x,k),Z=U.c,z=U.r,S=U.e),g=S+F+1,se=Z[g],w=k/2,z=z||g<0||Z[g+1]!=null,z=x<4?(se!=null||z)&&(x==0||x==(U.s<0?3:2)):se>w||se==w&&(x==4||z||x==6&&Z[g-1]&1||x==(U.s<0?8:7)),g<1||!Z[0])v=z?We(b.charAt(1),-F,b.charAt(0)):b.charAt(0);else{if(Z.length=g,z)for(--k;++Z[--g]>k;)Z[g]=0,g||(++S,Z=[1].concat(Z));for(w=Z.length;!Z[--w];);for(se=0,v="";se<=w;v+=b.charAt(Z[se++]));v=We(v,S,b.charAt(0))}return v}}(),e=function(){function f(p,k,V){var E,b,g,S,w=0,z=p.length,U=k%Ke,Z=k/Ke|0;for(p=p.slice();z--;)g=p[z]%Ke,S=p[z]/Ke|0,E=Z*g+S*U,b=U*g+E%Ke*Ke+w,w=(b/V|0)+(E/Ke|0)+Z*S,p[z]=b%V;return w&&(p=[w].concat(p)),p}function c(p,k,V,E){var b,g;if(V!=E)g=V>E?1:-1;else for(b=g=0;b<V;b++)if(p[b]!=k[b]){g=p[b]>k[b]?1:-1;break}return g}function v(p,k,V,E){for(var b=0;V--;)p[V]-=b,b=p[V]<k[V]?1:0,p[V]=b*E+p[V]-k[V];for(;!p[0]&&p.length>1;p.splice(0,1));}return function(p,k,V,E,b){var g,S,w,z,U,Z,ee,se,F,x,J,j,K,Y,ve,ke,Ve,Ee=p.s==k.s?1:-1,Ie=p.c,ae=k.c;if(!Ie||!Ie[0]||!ae||!ae[0])return new y(!p.s||!k.s||(Ie?ae&&Ie[0]==ae[0]:!ae)?NaN:Ie&&Ie[0]==0||!ae?Ee*0:Ee/0);for(se=new y(Ee),F=se.c=[],S=p.e-k.e,Ee=V+S+1,b||(b=Ge,S=je(p.e/me)-je(k.e/me),Ee=Ee/me|0),w=0;ae[w]==(Ie[w]||0);w++);if(ae[w]>(Ie[w]||0)&&S--,Ee<0)F.push(1),z=!0;else{for(Y=Ie.length,ke=ae.length,w=0,Ee+=2,U=Oe(b/(ae[0]+1)),U>1&&(ae=f(ae,U,b),Ie=f(Ie,U,b),ke=ae.length,Y=Ie.length),K=ke,x=Ie.slice(0,ke),J=x.length;J<ke;x[J++]=0);Ve=ae.slice(),Ve=[0].concat(Ve),ve=ae[0],ae[1]>=b/2&&ve++;do{if(U=0,g=c(ae,x,ke,J),g<0){if(j=x[0],ke!=J&&(j=j*b+(x[1]||0)),U=Oe(j/ve),U>1)for(U>=b&&(U=b-1),Z=f(ae,U,b),ee=Z.length,J=x.length;c(Z,x,ee,J)==1;)U--,v(Z,ke<ee?Ve:ae,ee,b),ee=Z.length,g=1;else U==0&&(g=U=1),Z=ae.slice(),ee=Z.length;if(ee<J&&(Z=[0].concat(Z)),v(x,Z,J,b),J=x.length,g==-1)for(;c(ae,x,ke,J)<1;)U++,v(x,ke<J?Ve:ae,J,b),J=x.length}else g===0&&(U++,x=[0]);F[w++]=U,x[0]?x[J++]=Ie[K]||0:(x=[Ie[K]],J=1)}while((K++<Y||x[0]!=null)&&Ee--);z=x[0]!=null,F[0]||F.splice(0,1)}if(b==Ge){for(w=1,Ee=F[0];Ee>=10;Ee/=10,w++);P(se,V+(se.e=w+S*me-1)+1,E,z)}else se.e=S,se.r=+z;return se}}();function A(f,c,v,p){var k,V,E,b,g;if(v==null?v=h:Ce(v,0,8),!f.c)return f.toString();if(k=f.c[0],E=f.e,c==null)g=xe(f.c),g=p==1||p==2&&(E<=i||E>=a)?vt(g,E):We(g,E,"0");else if(f=P(new y(f),c,v),V=f.e,g=xe(f.c),b=g.length,p==1||p==2&&(c<=V||V<=i)){for(;b<c;g+="0",b++);g=vt(g,V)}else if(c-=E,g=We(g,V,"0"),V+1>b){if(--c>0)for(g+=".";c--;g+="0");}else if(c+=V-b,c>0)for(V+1==b&&(g+=".");c--;g+="0");return f.s<0&&k?"-"+g:g}function T(f,c){for(var v,p,k=1,V=new y(f[0]);k<f.length;k++)p=new y(f[k]),(!p.s||(v=nt(V,p))===c||v===0&&V.s===c)&&(V=p);return V}function H(f,c,v){for(var p=1,k=c.length;!c[--k];c.pop());for(k=c[0];k>=10;k/=10,p++);return(v=p+v*me-1)>u?f.c=f.e=null:v<d?f.c=[f.e=0]:(f.e=v,f.c=c),f}l=function(){var f=/^(-?)0([xbo])(?=\w[\w.]*$)/i,c=/^([^.]+)\.$/,v=/^\.([^.]+)$/,p=/^-?(Infinity|NaN)$/,k=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(V,E,b,g){var S,w=b?E:E.replace(k,"");if(p.test(w))V.s=isNaN(w)?null:w<0?-1:1;else{if(!b&&(w=w.replace(f,function(z,U,Z){return S=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!g||g==S?U:z}),g&&(S=g,w=w.replace(c,"$1").replace(v,"0.$1")),E!=w))return new y(w,S);if(y.DEBUG)throw Error(He+"Not a"+(g?" base "+g:"")+" number: "+E);V.s=null}V.c=V.e=null}}();function P(f,c,v,p){var k,V,E,b,g,S,w,z=f.c,U=Dt;if(z){e:{for(k=1,b=z[0];b>=10;b/=10,k++);if(V=c-k,V<0)V+=me,E=c,g=z[S=0],w=Oe(g/U[k-E-1]%10);else if(S=Et((V+1)/me),S>=z.length)if(p){for(;z.length<=S;z.push(0));g=w=0,k=1,V%=me,E=V-me+1}else break e;else{for(g=b=z[S],k=1;b>=10;b/=10,k++);V%=me,E=V-me+k,w=E<0?0:Oe(g/U[k-E-1]%10)}if(p=p||c<0||z[S+1]!=null||(E<0?g:g%U[k-E-1]),p=v<4?(w||p)&&(v==0||v==(f.s<0?3:2)):w>5||w==5&&(v==4||p||v==6&&(V>0?E>0?g/U[k-E]:0:z[S-1])%10&1||v==(f.s<0?8:7)),c<1||!z[0])return z.length=0,p?(c-=f.e+1,z[0]=U[(me-c%me)%me],f.e=-c||0):z[0]=f.e=0,f;if(V==0?(z.length=S,b=1,S--):(z.length=S+1,b=U[me-V],z[S]=E>0?Oe(g/U[k-E]%U[E])*b:0),p)for(;;)if(S==0){for(V=1,E=z[0];E>=10;E/=10,V++);for(E=z[0]+=b,b=1;E>=10;E/=10,b++);V!=b&&(f.e++,z[0]==Ge&&(z[0]=1));break}else{if(z[S]+=b,z[S]!=Ge)break;z[S--]=0,b=1}for(V=z.length;z[--V]===0;z.pop());}f.e>u?f.c=f.e=null:f.e<d&&(f.c=[f.e=0])}return f}function Q(f){var c,v=f.e;return v===null?f.toString():(c=xe(f.c),c=v<=i||v>=a?vt(c,v):We(c,v,"0"),f.s<0?"-"+c:c)}return s.absoluteValue=s.abs=function(){var f=new y(this);return f.s<0&&(f.s=1),f},s.comparedTo=function(f,c){return nt(this,new y(f,c))},s.decimalPlaces=s.dp=function(f,c){var v,p,k,V=this;if(f!=null)return Ce(f,0,Ae),c==null?c=h:Ce(c,0,8),P(new y(V),f+V.e+1,c);if(!(v=V.c))return null;if(p=((k=v.length-1)-je(this.e/me))*me,k=v[k])for(;k%10==0;k/=10,p--);return p<0&&(p=0),p},s.dividedBy=s.div=function(f,c){return e(this,new y(f,c),r,h)},s.dividedToIntegerBy=s.idiv=function(f,c){return e(this,new y(f,c),0,1)},s.exponentiatedBy=s.pow=function(f,c){var v,p,k,V,E,b,g,S,w,z=this;if(f=new y(f),f.c&&!f.isInteger())throw Error(He+"Exponent not an integer: "+Q(f));if(c!=null&&(c=new y(c)),b=f.e>14,!z.c||!z.c[0]||z.c[0]==1&&!z.e&&z.c.length==1||!f.c||!f.c[0])return w=new y(Math.pow(+Q(z),b?f.s*(2-mt(f)):+Q(f))),c?w.mod(c):w;if(g=f.s<0,c){if(c.c?!c.c[0]:!c.s)return new y(NaN);p=!g&&z.isInteger()&&c.isInteger(),p&&(z=z.mod(c))}else{if(f.e>9&&(z.e>0||z.e<-1||(z.e==0?z.c[0]>1||b&&z.c[1]>=24e7:z.c[0]<8e13||b&&z.c[0]<=9999975e7)))return V=z.s<0&&mt(f)?-0:0,z.e>-1&&(V=1/V),new y(g?1/V:V);N&&(V=Et(N/me+2))}for(b?(v=new y(.5),g&&(f.s=1),S=mt(f)):(k=Math.abs(+Q(f)),S=k%2),w=new y(o);;){if(S){if(w=w.times(z),!w.c)break;V?w.c.length>V&&(w.c.length=V):p&&(w=w.mod(c))}if(k){if(k=Oe(k/2),k===0)break;S=k%2}else if(f=f.times(v),P(f,f.e+1,1),f.e>14)S=mt(f);else{if(k=+Q(f),k===0)break;S=k%2}z=z.times(z),V?z.c&&z.c.length>V&&(z.c.length=V):p&&(z=z.mod(c))}return p?w:(g&&(w=o.div(w)),c?w.mod(c):V?P(w,N,h,E):w)},s.integerValue=function(f){var c=new y(this);return f==null?f=h:Ce(f,0,8),P(c,c.e+1,f)},s.isEqualTo=s.eq=function(f,c){return nt(this,new y(f,c))===0},s.isFinite=function(){return!!this.c},s.isGreaterThan=s.gt=function(f,c){return nt(this,new y(f,c))>0},s.isGreaterThanOrEqualTo=s.gte=function(f,c){return(c=nt(this,new y(f,c)))===1||c===0},s.isInteger=function(){return!!this.c&&je(this.e/me)>this.c.length-2},s.isLessThan=s.lt=function(f,c){return nt(this,new y(f,c))<0},s.isLessThanOrEqualTo=s.lte=function(f,c){return(c=nt(this,new y(f,c)))===-1||c===0},s.isNaN=function(){return!this.s},s.isNegative=function(){return this.s<0},s.isPositive=function(){return this.s>0},s.isZero=function(){return!!this.c&&this.c[0]==0},s.minus=function(f,c){var v,p,k,V,E=this,b=E.s;if(f=new y(f,c),c=f.s,!b||!c)return new y(NaN);if(b!=c)return f.s=-c,E.plus(f);var g=E.e/me,S=f.e/me,w=E.c,z=f.c;if(!g||!S){if(!w||!z)return w?(f.s=-c,f):new y(z?E:NaN);if(!w[0]||!z[0])return z[0]?(f.s=-c,f):new y(w[0]?E:h==3?-0:0)}if(g=je(g),S=je(S),w=w.slice(),b=g-S){for((V=b<0)?(b=-b,k=w):(S=g,k=z),k.reverse(),c=b;c--;k.push(0));k.reverse()}else for(p=(V=(b=w.length)<(c=z.length))?b:c,b=c=0;c<p;c++)if(w[c]!=z[c]){V=w[c]<z[c];break}if(V&&(k=w,w=z,z=k,f.s=-f.s),c=(p=z.length)-(v=w.length),c>0)for(;c--;w[v++]=0);for(c=Ge-1;p>b;){if(w[--p]<z[p]){for(v=p;v&&!w[--v];w[v]=c);--w[v],w[p]+=Ge}w[p]-=z[p]}for(;w[0]==0;w.splice(0,1),--S);return w[0]?H(f,w,S):(f.s=h==3?-1:1,f.c=[f.e=0],f)},s.modulo=s.mod=function(f,c){var v,p,k=this;return f=new y(f,c),!k.c||!f.s||f.c&&!f.c[0]?new y(NaN):!f.c||k.c&&!k.c[0]?new y(k):(C==9?(p=f.s,f.s=1,v=e(k,f,0,3),f.s=p,v.s*=p):v=e(k,f,0,C),f=k.minus(v.times(f)),!f.c[0]&&C==1&&(f.s=k.s),f)},s.multipliedBy=s.times=function(f,c){var v,p,k,V,E,b,g,S,w,z,U,Z,ee,se,F,x=this,J=x.c,j=(f=new y(f,c)).c;if(!J||!j||!J[0]||!j[0])return!x.s||!f.s||J&&!J[0]&&!j||j&&!j[0]&&!J?f.c=f.e=f.s=null:(f.s*=x.s,!J||!j?f.c=f.e=null:(f.c=[0],f.e=0)),f;for(p=je(x.e/me)+je(f.e/me),f.s*=x.s,g=J.length,z=j.length,g<z&&(ee=J,J=j,j=ee,k=g,g=z,z=k),k=g+z,ee=[];k--;ee.push(0));for(se=Ge,F=Ke,k=z;--k>=0;){for(v=0,U=j[k]%F,Z=j[k]/F|0,E=g,V=k+E;V>k;)S=J[--E]%F,w=J[E]/F|0,b=Z*S+w*U,S=U*S+b%F*F+ee[V]+v,v=(S/se|0)+(b/F|0)+Z*w,ee[V--]=S%se;ee[V]=v}return v?++p:ee.splice(0,1),H(f,ee,p)},s.negated=function(){var f=new y(this);return f.s=-f.s||null,f},s.plus=function(f,c){var v,p=this,k=p.s;if(f=new y(f,c),c=f.s,!k||!c)return new y(NaN);if(k!=c)return f.s=-c,p.minus(f);var V=p.e/me,E=f.e/me,b=p.c,g=f.c;if(!V||!E){if(!b||!g)return new y(k/0);if(!b[0]||!g[0])return g[0]?f:new y(b[0]?p:k*0)}if(V=je(V),E=je(E),b=b.slice(),k=V-E){for(k>0?(E=V,v=g):(k=-k,v=b),v.reverse();k--;v.push(0));v.reverse()}for(k=b.length,c=g.length,k-c<0&&(v=g,g=b,b=v,c=k),k=0;c;)k=(b[--c]=b[c]+g[c]+k)/Ge|0,b[c]=Ge===b[c]?0:b[c]%Ge;return k&&(b=[k].concat(b),++E),H(f,b,E)},s.precision=s.sd=function(f,c){var v,p,k,V=this;if(f!=null&&f!==!!f)return Ce(f,1,Ae),c==null?c=h:Ce(c,0,8),P(new y(V),f,c);if(!(v=V.c))return null;if(k=v.length-1,p=k*me+1,k=v[k]){for(;k%10==0;k/=10,p--);for(k=v[0];k>=10;k/=10,p++);}return f&&V.e+1>p&&(p=V.e+1),p},s.shiftedBy=function(f){return Ce(f,-It,It),this.times("1e"+f)},s.squareRoot=s.sqrt=function(){var f,c,v,p,k,V=this,E=V.c,b=V.s,g=V.e,S=r+4,w=new y("0.5");if(b!==1||!E||!E[0])return new y(!b||b<0&&(!E||E[0])?NaN:E?V:1/0);if(b=Math.sqrt(+Q(V)),b==0||b==1/0?(c=xe(E),(c.length+g)%2==0&&(c+="0"),b=Math.sqrt(+c),g=je((g+1)/2)-(g<0||g%2),b==1/0?c="5e"+g:(c=b.toExponential(),c=c.slice(0,c.indexOf("e")+1)+g),v=new y(c)):v=new y(b+""),v.c[0]){for(g=v.e,b=g+S,b<3&&(b=0);;)if(k=v,v=w.times(k.plus(e(V,k,S,1))),xe(k.c).slice(0,b)===(c=xe(v.c)).slice(0,b))if(v.e<g&&--b,c=c.slice(b-3,b+1),c=="9999"||!p&&c=="4999"){if(!p&&(P(k,k.e+r+2,0),k.times(k).eq(V))){v=k;break}S+=4,b+=4,p=1}else{(!+c||!+c.slice(1)&&c.charAt(0)=="5")&&(P(v,v.e+r+2,1),f=!v.times(v).eq(V));break}}return P(v,v.e+r+1,h,f)},s.toExponential=function(f,c){return f!=null&&(Ce(f,0,Ae),f++),A(this,f,c,1)},s.toFixed=function(f,c){return f!=null&&(Ce(f,0,Ae),f=f+this.e+1),A(this,f,c)},s.toFormat=function(f,c,v){var p,k=this;if(v==null)f!=null&&c&&typeof c=="object"?(v=c,c=null):f&&typeof f=="object"?(v=f,f=c=null):v=D;else if(typeof v!="object")throw Error(He+"Argument not an object: "+v);if(p=k.toFixed(f,c),k.c){var V,E=p.split("."),b=+v.groupSize,g=+v.secondaryGroupSize,S=v.groupSeparator||"",w=E[0],z=E[1],U=k.s<0,Z=U?w.slice(1):w,ee=Z.length;if(g&&(V=b,b=g,g=V,ee-=V),b>0&&ee>0){for(V=ee%b||b,w=Z.substr(0,V);V<ee;V+=b)w+=S+Z.substr(V,b);g>0&&(w+=S+Z.slice(V)),U&&(w="-"+w)}p=z?w+(v.decimalSeparator||"")+((g=+v.fractionGroupSize)?z.replace(new RegExp("\\d{"+g+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):z):w}return(v.prefix||"")+p+(v.suffix||"")},s.toFraction=function(f){var c,v,p,k,V,E,b,g,S,w,z,U,Z=this,ee=Z.c;if(f!=null&&(b=new y(f),!b.isInteger()&&(b.c||b.s!==1)||b.lt(o)))throw Error(He+"Argument "+(b.isInteger()?"out of range: ":"not an integer: ")+Q(b));if(!ee)return new y(Z);for(c=new y(o),S=v=new y(o),p=g=new y(o),U=xe(ee),V=c.e=U.length-Z.e-1,c.c[0]=Dt[(E=V%me)<0?me+E:E],f=!f||b.comparedTo(c)>0?V>0?c:S:b,E=u,u=1/0,b=new y(U),g.c[0]=0;w=e(b,c,0,1),k=v.plus(w.times(p)),k.comparedTo(f)!=1;)v=p,p=k,S=g.plus(w.times(k=S)),g=k,c=b.minus(w.times(k=c)),b=k;return k=e(f.minus(v),p,0,1),g=g.plus(k.times(S)),v=v.plus(k.times(p)),g.s=S.s=Z.s,V=V*2,z=e(S,p,V,h).minus(Z).abs().comparedTo(e(g,v,V,h).minus(Z).abs())<1?[S,p]:[g,v],u=E,z},s.toNumber=function(){return+Q(this)},s.toPrecision=function(f,c){return f!=null&&Ce(f,1,Ae),A(this,f,c,2)},s.toString=function(f){var c,v=this,p=v.s,k=v.e;return k===null?p?(c="Infinity",p<0&&(c="-"+c)):c="NaN":(f==null?c=k<=i||k>=a?vt(xe(v.c),k):We(xe(v.c),k,"0"):f===10&&O?(v=P(new y(v),r+k+1,h),c=We(xe(v.c),v.e,"0")):(Ce(f,2,q.length,"Base"),c=t(We(xe(v.c),k,"0"),10,f,p,!0)),p<0&&v.c[0]&&(c="-"+c)),c},s.valueOf=s.toJSON=function(){return Q(this)},s._isBigNumber=!0,s[Symbol.toStringTag]="BigNumber",s[Symbol.for("nodejs.util.inspect.custom")]=s.valueOf,n!=null&&y.set(n),y}function je(n){var e=n|0;return n>0||n===e?e:e-1}function xe(n){for(var e,t,l=1,s=n.length,o=n[0]+"";l<s;){for(e=n[l++]+"",t=me-e.length;t--;e="0"+e);o+=e}for(s=o.length;o.charCodeAt(--s)===48;);return o.slice(0,s+1||1)}function nt(n,e){var t,l,s=n.c,o=e.c,r=n.s,h=e.s,i=n.e,a=e.e;if(!r||!h)return null;if(t=s&&!s[0],l=o&&!o[0],t||l)return t?l?0:-h:r;if(r!=h)return r;if(t=r<0,l=i==a,!s||!o)return l?0:!s^t?1:-1;if(!l)return i>a^t?1:-1;for(h=(i=s.length)<(a=o.length)?i:a,r=0;r<h;r++)if(s[r]!=o[r])return s[r]>o[r]^t?1:-1;return i==a?0:i>a^t?1:-1}function Ce(n,e,t,l){if(n<e||n>t||n!==Oe(n))throw Error(He+(l||"Argument")+(typeof n=="number"?n<e||n>t?" out of range: ":" not an integer: ":" not a primitive number: ")+String(n))}function mt(n){var e=n.c.length-1;return je(n.e/me)==e&&n.c[e]%2!=0}function vt(n,e){return(n.length>1?n.charAt(0)+"."+n.slice(1):n)+(e<0?"e":"e+")+e}function We(n,e,t){var l,s;if(e<0){for(s=t+".";++e;s+=t);n=s+n}else if(l=n.length,++e>l){for(s=t,e-=l;--e;s+=t);n+=s}else e<l&&(n=n.slice(0,e)+"."+n.slice(e));return n}hn();rt(it);const Xe=(n,e,t={})=>{const{color:l="rgba(255,255,255,0)",duration:s=.2,ease:o="power1.in",offset:r={from:"0%",to:"100%"},position:h="+=0",...i}=t,{from:a="0%",to:d="100%"}=r,u=Array.isArray(e)?e.map(m=>m.getAttribute("stop-color")):e.getAttribute("stop-color");n.fromTo(e,{attr:{offset:a,"stop-color":l}},{attr:{offset:d,"stop-color":l},duration:s,ease:o,...i},h).to(e,{attr:{offset:d,"stop-color":m=>Array.isArray(e)?u[m]:u},duration:s,ease:o,...i},"-=50%")},Ps=async n=>new Promise(e=>{var J,j,K,Y,ve,ke,Ve,Ee,Ie,ae,ft,Te,Mt,Lt,Bt,zt,Tt,Ht;const t=ot.timeline({onComplete:e}),l=.01,s=document.querySelectorAll(".embedding .content .last");t.fromTo(s,{opacity:0},{opacity:1,duration:l});const o=document.querySelectorAll(".sankey .embedding .last");t.set(o,{opacity:.6});const r=(J=document.querySelector("#gray-blue-last"))==null?void 0:J.querySelectorAll("stop")[1];Xe(t,r,{duration:l*1.5});const h=document.querySelectorAll(".attention .column .vector.last");t.fromTo(h,{opacity:0},{opacity:1,duration:l});const i=document.querySelectorAll(".sankey-top .attention .last"),a=document.querySelectorAll(".sankey-back .attention .last"),d=document.querySelectorAll(".sankey-top .attention .to-attention-out");t.set(i,{opacity:1}),t.set([a,d],{opacity:.4});const u=(j=document.querySelector("#blue-blue-last"))==null?void 0:j.querySelectorAll("stop")[1],m=(K=document.querySelector("#red-red-last"))==null?void 0:K.querySelectorAll("stop")[1],C=(Y=document.querySelector("#green-green-last"))==null?void 0:Y.querySelectorAll("stop")[1],N=(ve=document.querySelector("#blue-blue2-last"))==null?void 0:ve.querySelectorAll("stop")[1],D=(ke=document.querySelector("#red-red2-last"))==null?void 0:ke.querySelectorAll("stop")[1],q=(Ve=document.querySelector("#green-green2-last"))==null?void 0:Ve.querySelectorAll("stop")[1];Xe(t,[u,m,C,N,D,q],{});const O=document.querySelectorAll(".attention .head-block .qkv .column .last");t.fromTo(O,{opacity:0},{opacity:1,duration:l});const y=document.querySelectorAll(".sankey g.attention path.key-to-attention"),A=document.querySelectorAll(".sankey g.attention path.query-to-attention");document.querySelectorAll(".sankey g.attention path.to-attention-out");const T=document.querySelector(".attention .attention-result");[...y,...A].forEach($t=>{const Pt=$t.getTotalLength();$t.style.strokeDasharray=Pt,$t.style.strokeDashoffset=Pt});const H=.4,P=Number((H/n).toFixed(2));t.to(y,{strokeDashoffset:0,stagger:P,duration:H,ease:"power2.out"},"<+=50%").to(A,{strokeDashoffset:0,stagger:P,duration:H,ease:"power2.out"},"<").from(T.querySelectorAll("svg circle"),{scale:0,transformOrigin:"50% 50%",opacity:0,delay:H/n,stagger:Number((H/Math.pow(n,2)).toFixed(2)),ease:"power2.out",duration:H},"<");const Q=(Ee=document.querySelector("#green-purple"))==null?void 0:Ee.querySelectorAll("stop")[1],f=(Ie=document.querySelector("#transparent-purple2"))==null?void 0:Ie.querySelectorAll("stop")[1];Xe(t,[f,Q],{});const c=document.querySelectorAll(".attention .head-block .head-out .column .last");t.fromTo(c,{opacity:0},{opacity:1,duration:l});const v=(ae=document.querySelector("#purple-purple-last"))==null?void 0:ae.querySelectorAll("stop")[1],p=(ft=document.querySelector("#transparent-purple-last"))==null?void 0:ft.querySelectorAll("stop")[1];Xe(t,[v,p],{stagger:.2});const k=document.querySelectorAll(".mlp .first-layer .cell.last");t.fromTo(k,{opacity:0},{opacity:1,duration:l});const V=document.querySelectorAll(".sankey .mlp .last");t.set(V,{opacity:.4}),(Te=document.querySelector("#purple-indigo"))==null||Te.querySelectorAll("stop")[1];const E=(Mt=document.querySelector("#purple-indigo-last"))==null?void 0:Mt.querySelectorAll("stop")[1];Xe(t,E,{});const b=document.querySelectorAll(".mlp .second-layer .projections .cell.last");t.fromTo(b,{opacity:0},{opacity:1,duration:l}),(Lt=document.querySelector("#indigo-blue"))==null||Lt.querySelectorAll("stop")[1];const g=(Bt=document.querySelector("#indigo-blue-last"))==null?void 0:Bt.querySelectorAll("stop")[1];Xe(t,g,{});const S=document.querySelectorAll(".mlp .second-layer .ouputs .last");t.fromTo(S,{opacity:0},{opacity:1,duration:l});const w=document.querySelectorAll(".sankey .transformer-blocks .last");t.set(w,{opacity:.6});const z=(zt=document.querySelector("#blue-white-blue-last"))==null?void 0:zt.querySelectorAll("stop")[1],U=(Tt=document.querySelector("#blue-white-blue-last"))==null?void 0:Tt.querySelectorAll("stop")[3],Z=ot.timeline({});Xe(Z,z,{duration:.3,offset:{to:"50%"},ease:"sine.inOut"}),Xe(Z,U,{duration:.3,offset:{from:"50%"},ease:"sine.inOut"}),t.add(Z);const ee=document.querySelectorAll(".transformer-blocks .cell.last");t.fromTo(ee,{opacity:0},{opacity:1,duration:l});const se=document.querySelectorAll(".sankey .linear-softmax .last");t.set(se,{opacity:.6});const F=(Ht=document.querySelector("#blue-gray"))==null?void 0:Ht.querySelectorAll("stop")[1];Xe(t,F,{});const x=document.querySelectorAll(".softmax .content");t.fromTo(x,{opacity:0},{opacity:1,duration:l})}),xs=async()=>{};_n.wasm.wasmPaths="https://cdn.jsdelivr.net/npm/onnxruntime-web/dist/";const Os=async(n,e)=>{jt.set(!0);const{token_ids:t,input_tokens:l}=await Rs(n);Ze.set(l);const{outputs:s,prediction:o}=await Us(t),r=rn(o,e),h=an(r);ut.set({outputs:s,prediction:r,sampled:h}),await Ps(l.length),wt.set(h),jt.set(!1)},js=async(n,e)=>{const t=rn(n,e),l=an(t);ut.update(s=>({...s,prediction:t})),await xs(),wt.set(l)},Gs=n=>{const e=Math.max(...n),t=n.map(s=>Math.exp(s-e)),l=t.reduce((s,o)=>s+o,0);return t.map(s=>s/l)},Rs=async n=>{const e=await on.from_pretrained("Xenova/gpt2"),t=e.encode(n),l=t.map(s=>e.decode([s])).flat();return{token_ids:t,input_tokens:l}},Fs=(n,e,t,l)=>{const s=Array.from(n).map((o,r)=>({tokenId:r,logit:o,probability:e[r]}));return s.sort((o,r)=>r.probability-o.probability),s.slice(0,l).map((o,r)=>({...o,rank:r,token:t.decode([o.tokenId])}))},Us=async n=>{try{const e=new bn("int64",n,[1,n.length]),t=gn(sn);if(!t)throw new Error("Model session is not initialized.");const l={input:e},s=await t.run(l),o=s.linear_output.data;console.log(o);const r=Gs(o),h=await on.from_pretrained("Xenova/gpt2"),a=Fs(o,r,h,100),d=Ws.reduce((u,m)=>{const C=s[m];return u[m]=C,u},{});return console.log(d),{outputs:d,prediction:a}}catch(e){throw console.error("Error during inference:",e.message),e}},Ws=["tok_emb","transformer_wpe_weight","pos_emb","input_emb","input_emb_dropout","block_0_ln_1_input_mean","block_0_ln_1_input_var","block_0_ln_1_input_normalized","block_0_ln_1_weight","block_0_ln_1_bias","block_0_ln_1_output","block_0_attn_head_0_q_weights","block_0_attn_head_0_k_weights","block_0_attn_head_0_v_weights","block_0_attn_head_0_q_bias","block_0_attn_head_0_k_bias","block_0_attn_head_0_v_bias","block_0_attn_head_0_q","block_0_attn_head_0_k","block_0_attn_head_0_v","block_0_attn_head_0_q_transposed","block_0_attn_head_0_k_transposed","block_0_attn_head_0_v_transposed","block_0_attn_head_0_attn","block_0_attn_head_0_attn_scaled","block_0_attn_head_0_attn_masked","block_0_attn_head_0_attn_softmax","block_0_attn_head_0_attn_dropout","block_0_attn_head_0_v_output","block_0_attn_v_output_combined","block_0_attn_proj_weights","block_0_attn_proj_bias","block_0_attn_attn_output","block_0_res_1","block_0_ln_2_input_mean","block_0_ln_2_input_var","block_0_ln_2_input_normalized","block_0_ln_2_weight","block_0_ln_2_bias","block_0_ln_2_output","block_0_mlp_linear_1_weight","block_0_mlp_linear_1_bias","block_0_mlp_linear_1_output","block_0_mlp_gelu_output","block_0_mlp_linear_2_weight","block_0_mlp_linear_2_bias","block_0_mlp_linear_2_output","block_0_mlp_output_after_dropout","block_0_res_2","ln_f_input_mean","ln_f_input_var","ln_f_input_normalized","ln_f_weight","ln_f_bias","ln_f_output","linear_weight","linear_output"];function Xs(n){let e,t="Drop out is";return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-ohkp45"&&(e.textContent=t),this.h()},h(){_(e,"class","dropout-content")},m(l,s){W(l,e,s)},p:qe,d(l){l&&$(e)}}}function Zs(n){let e,t;return e=new qt({props:{class:oe("popover dropout-popover text-sm",n[1]),title:"Drop out",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],$$slots:{default:[Xs]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,[s]){const o={};s&2&&(o.class=oe("popover dropout-popover text-sm",l[1])),s&1&&(o.offset=l[0]),s&4&&(o.triggeredBy=l[2]),s&8&&(o.trigger=l[3]),s&16&&(o.placement=l[4]),s&32&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function Ys(n,e,t){let{offset:l=void 0}=e,{className:s=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:r="hover"}=e,{placement:h="right"}=e;return n.$$set=i=>{"offset"in i&&t(0,l=i.offset),"className"in i&&t(1,s=i.className),"triggeredBy"in i&&t(2,o=i.triggeredBy),"trigger"in i&&t(3,r=i.trigger),"placement"in i&&t(4,h=i.placement)},[l,s,o,r,h]}class Ks extends Me{constructor(e){super(),Le(this,e,Ys,Zs,Ne,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function Qs(n){let e,t="Layer normalization is";return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-qw3l61"&&(e.textContent=t),this.h()},h(){_(e,"class","ln-content")},m(l,s){W(l,e,s)},p:qe,d(l){l&&$(e)}}}function Js(n){let e,t;return e=new qt({props:{class:oe("popover ln-popover text-sm",n[1]),title:"Layer Normalization",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],$$slots:{default:[Qs]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,[s]){const o={};s&2&&(o.class=oe("popover ln-popover text-sm",l[1])),s&1&&(o.offset=l[0]),s&4&&(o.triggeredBy=l[2]),s&8&&(o.trigger=l[3]),s&16&&(o.placement=l[4]),s&32&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function eo(n,e,t){let{offset:l=void 0}=e,{className:s=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:r="hover"}=e,{placement:h="right"}=e;return n.$$set=i=>{"offset"in i&&t(0,l=i.offset),"className"in i&&t(1,s=i.className),"triggeredBy"in i&&t(2,o=i.triggeredBy),"trigger"in i&&t(3,r=i.trigger),"placement"in i&&t(4,h=i.placement)},[l,s,o,r,h]}class to extends Me{constructor(e){super(),Le(this,e,eo,Js,Ne,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function lo(n){let e,t=`The GELU (Gaussian Error Linear Unit) activation function combines linear and non-linear
		behavior by scaling inputs using the Gaussian cumulative distribution function. It retains small
		negative values for smoother gradients and is effective in models like BERT.`;return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-1ri460b"&&(e.textContent=t),this.h()},h(){_(e,"class","activation-content svelte-60plg2")},m(l,s){W(l,e,s)},p:qe,d(l){l&&$(e)}}}function no(n){let e,t;return e=new qt({props:{class:oe("popover activation-popover text-sm",n[1]),title:"GeLu Activation",offset:n[0],triggeredBy:n[2],trigger:n[3],placement:n[4],$$slots:{default:[lo]},$$scope:{ctx:n}}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,[s]){const o={};s&2&&(o.class=oe("popover activation-popover text-sm",l[1])),s&1&&(o.offset=l[0]),s&4&&(o.triggeredBy=l[2]),s&8&&(o.trigger=l[3]),s&16&&(o.placement=l[4]),s&32&&(o.$$scope={dirty:s,ctx:l}),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function so(n,e,t){let{offset:l=void 0}=e,{className:s=void 0}=e,{triggeredBy:o=void 0}=e,{trigger:r="hover"}=e,{placement:h="right"}=e;return n.$$set=i=>{"offset"in i&&t(0,l=i.offset),"className"in i&&t(1,s=i.className),"triggeredBy"in i&&t(2,o=i.triggeredBy),"trigger"in i&&t(3,r=i.trigger),"placement"in i&&t(4,h=i.placement)},[l,s,o,r,h]}class oo extends Me{constructor(e){super(),Le(this,e,so,no,Ne,{offset:0,className:1,triggeredBy:2,trigger:3,placement:4})}}function wl(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function $l(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function yl(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function El(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function Il(n,e,t){const l=n.slice();return l[20]=e[t],l[22]=t,l}function ro(n){let e,t,l,s,o,r,h=ce(n[8]),i=[];for(let d=0;d<h.length;d+=1)i[d]=Dl(wl(n,h,d));const a=d=>te(i[d],1,1,()=>{i[d]=null});return{c(){e=M("div");for(let d=0;d<i.length;d+=1)i[d].c();this.h()},l(d){e=L(d,"DIV",{id:!0,class:!0,role:!0});var u=B(e);for(let m=0;m<i.length;m+=1)i[m].l(u);u.forEach($),this.h()},h(){_(e,"id",t=`${n[0]}-end`),_(e,"class",l=re(oe("column residual",n[1]))+" svelte-1pw6sap"),_(e,"role","group")},m(d,u){W(d,e,u);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(e,null);s=!0,o||(r=[_e(e,"mouseenter",n[17]),_e(e,"mouseleave",n[18])],o=!0)},p(d,u){if(u&322){h=ce(d[8]);let m;for(m=0;m<h.length;m+=1){const C=wl(d,h,m);i[m]?(i[m].p(C,u),X(i[m],1)):(i[m]=Dl(C),i[m].c(),X(i[m],1),i[m].m(e,null))}for(Be(),m=h.length;m<i.length;m+=1)a(m);ze()}(!s||u&1&&t!==(t=`${d[0]}-end`))&&_(e,"id",t),(!s||u&2&&l!==(l=re(oe("column residual",d[1]))+" svelte-1pw6sap"))&&_(e,"class",l)},i(d){if(!s){for(let u=0;u<h.length;u+=1)X(i[u]);s=!0}},o(d){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)te(i[u]);s=!1},d(d){d&&$(e),De(i,d),o=!1,Pe(r)}}}function io(n){let e,t,l,s,o,r,h=ce(n[8]),i=[];for(let d=0;d<h.length;d+=1)i[d]=Cl($l(n,h,d));const a=d=>te(i[d],1,1,()=>{i[d]=null});return{c(){e=M("div");for(let d=0;d<i.length;d+=1)i[d].c();this.h()},l(d){e=L(d,"DIV",{id:!0,class:!0,role:!0});var u=B(e);for(let m=0;m<i.length;m+=1)i[m].l(u);u.forEach($),this.h()},h(){_(e,"id",t=`${n[0]}-start`),_(e,"class",l=re(oe("column residual",n[1]))+" svelte-1pw6sap"),_(e,"role","group")},m(d,u){W(d,e,u);for(let m=0;m<i.length;m+=1)i[m]&&i[m].m(e,null);s=!0,o||(r=[_e(e,"mouseenter",n[15]),_e(e,"mouseleave",n[16])],o=!0)},p(d,u){if(u&290){h=ce(d[8]);let m;for(m=0;m<h.length;m+=1){const C=$l(d,h,m);i[m]?(i[m].p(C,u),X(i[m],1)):(i[m]=Cl(C),i[m].c(),X(i[m],1),i[m].m(e,null))}for(Be(),m=h.length;m<i.length;m+=1)a(m);ze()}(!s||u&1&&t!==(t=`${d[0]}-start`))&&_(e,"id",t),(!s||u&2&&l!==(l=re(oe("column residual",d[1]))+" svelte-1pw6sap"))&&_(e,"class",l)},i(d){if(!s){for(let u=0;u<h.length;u+=1)X(i[u]);s=!0}},o(d){i=i.filter(Boolean);for(let u=0;u<i.length;u+=1)te(i[u]);s=!1},d(d){d&&$(e),De(i,d),o=!1,Pe(r)}}}function ao(n){let e,t,l,s,o,r,h,i=ce(n[8]),a=[];for(let u=0;u<i.length;u+=1)a[u]=Vl(yl(n,i,u));const d=u=>te(a[u],1,1,()=>{a[u]=null});return l=new to({props:{triggeredBy:`#${n[0]}`,open:n[7]}}),{c(){e=M("div");for(let u=0;u<a.length;u+=1)a[u].c();t=G(),ue(l.$$.fragment),this.h()},l(u){e=L(u,"DIV",{id:!0,class:!0,role:!0});var m=B(e);for(let C=0;C<a.length;C+=1)a[C].l(m);t=R(m),fe(l.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",s=re(oe("column ln",n[1]))+" svelte-1pw6sap"),_(e,"role","group")},m(u,m){W(u,e,m);for(let C=0;C<a.length;C+=1)a[C]&&a[C].m(e,null);I(e,t),he(l,e,null),o=!0,r||(h=[_e(e,"mouseenter",n[13]),_e(e,"mouseleave",n[14])],r=!0)},p(u,m){if(m&386){i=ce(u[8]);let N;for(N=0;N<i.length;N+=1){const D=yl(u,i,N);a[N]?(a[N].p(D,m),X(a[N],1)):(a[N]=Vl(D),a[N].c(),X(a[N],1),a[N].m(e,t))}for(Be(),N=i.length;N<a.length;N+=1)d(N);ze()}const C={};m&1&&(C.triggeredBy=`#${u[0]}`),m&128&&(C.open=u[7]),l.$set(C),(!o||m&1)&&_(e,"id",u[0]),(!o||m&2&&s!==(s=re(oe("column ln",u[1]))+" svelte-1pw6sap"))&&_(e,"class",s)},i(u){if(!o){for(let m=0;m<i.length;m+=1)X(a[m]);X(l.$$.fragment,u),o=!0}},o(u){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)te(a[m]);te(l.$$.fragment,u),o=!1},d(u){u&&$(e),De(a,u),de(l),r=!1,Pe(h)}}}function co(n){let e,t,l,s,o,r,h,i=ce(n[8]),a=[];for(let u=0;u<i.length;u+=1)a[u]=Sl(El(n,i,u));const d=u=>te(a[u],1,1,()=>{a[u]=null});return l=new Ks({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=M("div");for(let u=0;u<a.length;u+=1)a[u].c();t=G(),ue(l.$$.fragment),this.h()},l(u){e=L(u,"DIV",{id:!0,class:!0,role:!0});var m=B(e);for(let C=0;C<a.length;C+=1)a[C].l(m);t=R(m),fe(l.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",s=re(oe("column dropout",n[1]))+" svelte-1pw6sap"),_(e,"role","group")},m(u,m){W(u,e,m);for(let C=0;C<a.length;C+=1)a[C]&&a[C].m(e,null);I(e,t),he(l,e,null),o=!0,r||(h=[_e(e,"mouseenter",n[11]),_e(e,"mouseleave",n[12])],r=!0)},p(u,m){if(m&274){i=ce(u[8]);let N;for(N=0;N<i.length;N+=1){const D=El(u,i,N);a[N]?(a[N].p(D,m),X(a[N],1)):(a[N]=Sl(D),a[N].c(),X(a[N],1),a[N].m(e,t))}for(Be(),N=i.length;N<a.length;N+=1)d(N);ze()}const C={};m&1&&(C.triggeredBy=`#${u[0]}`),l.$set(C),(!o||m&1)&&_(e,"id",u[0]),(!o||m&2&&s!==(s=re(oe("column dropout",u[1]))+" svelte-1pw6sap"))&&_(e,"class",s)},i(u){if(!o){for(let m=0;m<i.length;m+=1)X(a[m]);X(l.$$.fragment,u),o=!0}},o(u){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)te(a[m]);te(l.$$.fragment,u),o=!1},d(u){u&&$(e),De(a,u),de(l),r=!1,Pe(h)}}}function uo(n){let e,t,l,s,o,r,h,i=ce(n[8]),a=[];for(let u=0;u<i.length;u+=1)a[u]=ql(Il(n,i,u));const d=u=>te(a[u],1,1,()=>{a[u]=null});return l=new oo({props:{triggeredBy:`#${n[0]}`,offset:1}}),{c(){e=M("div");for(let u=0;u<a.length;u+=1)a[u].c();t=G(),ue(l.$$.fragment),this.h()},l(u){e=L(u,"DIV",{id:!0,class:!0,role:!0});var m=B(e);for(let C=0;C<a.length;C+=1)a[C].l(m);t=R(m),fe(l.$$.fragment,m),m.forEach($),this.h()},h(){_(e,"id",n[0]),_(e,"class",s=re(oe("column activation",n[1]))+" svelte-1pw6sap"),_(e,"role","group")},m(u,m){W(u,e,m);for(let C=0;C<a.length;C+=1)a[C]&&a[C].m(e,null);I(e,t),he(l,e,null),o=!0,r||(h=[_e(e,"mouseenter",n[9]),_e(e,"mouseleave",n[10])],r=!0)},p(u,m){if(m&266){i=ce(u[8]);let N;for(N=0;N<i.length;N+=1){const D=Il(u,i,N);a[N]?(a[N].p(D,m),X(a[N],1)):(a[N]=ql(D),a[N].c(),X(a[N],1),a[N].m(e,t))}for(Be(),N=i.length;N<a.length;N+=1)d(N);ze()}const C={};m&1&&(C.triggeredBy=`#${u[0]}`),l.$set(C),(!o||m&1)&&_(e,"id",u[0]),(!o||m&2&&s!==(s=re(oe("column activation",u[1]))+" svelte-1pw6sap"))&&_(e,"class",s)},i(u){if(!o){for(let m=0;m<i.length;m+=1)X(a[m]);X(l.$$.fragment,u),o=!0}},o(u){a=a.filter(Boolean);for(let m=0;m<a.length;m+=1)te(a[m]);te(l.$$.fragment,u),o=!1},d(u){u&&$(e),De(a,u),de(l),r=!1,Pe(h)}}}function Dl(n){let e,t;return e=new pt({props:{className:oe(n[1],{last:n[22]===n[8].length-1}),type:"residual-end",head:n[22]===0,active:n[6]}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,s){const o={};s&258&&(o.className=oe(l[1],{last:l[22]===l[8].length-1})),s&64&&(o.active=l[6]),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function Cl(n){let e,t;return e=new pt({props:{className:oe(n[1],{last:n[22]===n[8].length-1}),type:"residual-start",head:n[22]===0,active:n[5]}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,s){const o={};s&258&&(o.className=oe(l[1],{last:l[22]===l[8].length-1})),s&32&&(o.active=l[5]),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function Vl(n){let e,t;return e=new pt({props:{className:oe(n[1],{last:n[22]===n[8].length-1}),type:"ln",tail:n[22]===n[8].length-1,active:n[7]}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,s){const o={};s&258&&(o.className=oe(l[1],{last:l[22]===l[8].length-1})),s&256&&(o.tail=l[22]===l[8].length-1),s&128&&(o.active=l[7]),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function Sl(n){let e,t;return e=new pt({props:{className:oe(n[1],{last:n[22]===n[8].length-1}),type:"dropout",tail:n[22]===n[8].length-1,active:n[4]}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,s){const o={};s&258&&(o.className=oe(l[1],{last:l[22]===l[8].length-1})),s&256&&(o.tail=l[22]===l[8].length-1),s&16&&(o.active=l[4]),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function ql(n){let e,t;return e=new pt({props:{className:oe(n[1],{last:n[22]===n[8].length-1}),type:"activation",tail:n[22]===n[8].length-1,active:n[3]}}),{c(){ue(e.$$.fragment)},l(l){fe(e.$$.fragment,l)},m(l,s){he(e,l,s),t=!0},p(l,s){const o={};s&258&&(o.className=oe(l[1],{last:l[22]===l[8].length-1})),s&256&&(o.tail=l[22]===l[8].length-1),s&8&&(o.active=l[3]),e.$set(o)},i(l){t||(X(e.$$.fragment,l),t=!0)},o(l){te(e.$$.fragment,l),t=!1},d(l){de(e,l)}}}function fo(n){let e,t,l,s;const o=[uo,co,ao,io,ro],r=[];function h(i,a){return i[2]==="activation"?0:i[2]==="dropout"?1:i[2]==="ln"?2:i[2]==="residual-start"?3:i[2]==="residual-end"?4:-1}return~(e=h(n))&&(t=r[e]=o[e](n)),{c(){t&&t.c(),l=lt()},l(i){t&&t.l(i),l=lt()},m(i,a){~e&&r[e].m(i,a),W(i,l,a),s=!0},p(i,[a]){let d=e;e=h(i),e===d?~e&&r[e].p(i,a):(t&&(Be(),te(r[d],1,1,()=>{r[d]=null}),ze()),~e?(t=r[e],t?t.p(i,a):(t=r[e]=o[e](i),t.c()),X(t,1),t.m(l.parentNode,l)):t=null)},i(i){s||(X(t),s=!0)},o(i){te(t),s=!1},d(i){i&&$(l),~e&&r[e].d(i)}}}function ho(n,e,t){let l;be(n,Ze,P=>t(8,l=P));let{id:s}=e,{className:o=void 0}=e,{type:r=void 0}=e,h=!1,i=!1,a=!1,d=!1,u=!1;dt(()=>{});const m=()=>{t(3,h=!0)},C=()=>{t(3,h=!1)},N=()=>{t(4,i=!0)},D=()=>{t(4,i=!1)},q=()=>{t(7,u=!0)},O=()=>{t(7,u=!1)},y=()=>{t(5,a=!0)},A=()=>{t(5,a=!1)},T=()=>{t(6,d=!0)},H=()=>{t(6,d=!1)};return n.$$set=P=>{"id"in P&&t(0,s=P.id),"className"in P&&t(1,o=P.className),"type"in P&&t(2,r=P.type)},[s,o,r,h,i,a,d,u,l,m,C,N,D,q,O,y,A,T,H]}class Fe extends Me{constructor(e){super(),Le(this,e,ho,fo,Ne,{id:0,className:1,type:2})}}function Al(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Nl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Ml(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Ll(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Bl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function zl(n,e,t){const l=n.slice();return l[19]=e[t],l[21]=t,l}function Tl(n){let e,t="Token";return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-6k2z6t"&&(e.textContent=t),this.h()},h(){_(e,"class","subtitle embedding-detail svelte-rng1pj")},m(l,s){W(l,e,s)},d(l){l&&$(e)}}}function Hl(n){let e,t,l=n[19]+"",s;return{c(){e=M("div"),t=M("span"),s=pe(l),this.h()},l(o){e=L(o,"DIV",{class:!0});var r=B(e);t=L(r,"SPAN",{class:!0});var h=B(t);s=ge(h,l),h.forEach($),r.forEach($),this.h()},h(){_(t,"class","label"),_(e,"class","cell svelte-rng1pj"),ne(e,"last",n[21]===n[3].length-1)},m(o,r){W(o,e,r),I(e,t),I(t,s)},p(o,r){r&8&&l!==(l=o[19]+"")&&Se(s,l),r&8&&ne(e,"last",o[21]===o[3].length-1)},d(o){o&&$(e)}}}function Pl(n){let e,t,l="Token Embedding",s,o,r,h,i,a,d="Positional Embedding",u,m,C,N,D=ce(n[3]),q=[];for(let c=0;c<D.length;c+=1)q[c]=xl(Bl(n,D,c));const O=c=>te(q[c],1,1,()=>{q[c]=null});let y=ce(n[3]),A=[];for(let c=0;c<y.length;c+=1)A[c]=Ol(Ll(n,y,c));let T=ce(n[3]),H=[];for(let c=0;c<T.length;c+=1)H[c]=jl(Ml(n,T,c));const P=c=>te(H[c],1,1,()=>{H[c]=null});let Q=ce(n[3]),f=[];for(let c=0;c<Q.length;c+=1)f[c]=Gl(Nl(n,Q,c));return{c(){e=M("div"),t=M("div"),t.textContent=l,s=G();for(let c=0;c<q.length;c+=1)q[c].c();o=G(),r=M("div");for(let c=0;c<A.length;c+=1)A[c].c();h=G(),i=M("div"),a=M("div"),a.textContent=d,u=G();for(let c=0;c<H.length;c+=1)H[c].c();m=G(),C=M("div");for(let c=0;c<f.length;c+=1)f[c].c();this.h()},l(c){e=L(c,"DIV",{class:!0});var v=B(e);t=L(v,"DIV",{class:!0,"data-svelte-h":!0}),ye(t)!=="svelte-1xxrpp9"&&(t.textContent=l),s=R(v);for(let E=0;E<q.length;E+=1)q[E].l(v);v.forEach($),o=R(c),r=L(c,"DIV",{class:!0});var p=B(r);for(let E=0;E<A.length;E+=1)A[E].l(p);p.forEach($),h=R(c),i=L(c,"DIV",{class:!0});var k=B(i);a=L(k,"DIV",{class:!0,"data-svelte-h":!0}),ye(a)!=="svelte-p605q8"&&(a.textContent=d),u=R(k);for(let E=0;E<H.length;E+=1)H[E].l(k);k.forEach($),m=R(c),C=L(c,"DIV",{class:!0});var V=B(C);for(let E=0;E<f.length;E+=1)f[E].l(V);V.forEach($),this.h()},h(){_(t,"class","subtitle"),_(e,"class","column token-embedding embedding-detail svelte-rng1pj"),_(r,"class","column symbol embedding-detail svelte-rng1pj"),_(a,"class","subtitle"),_(i,"class","column embedding-detail position-embedding svelte-rng1pj"),_(C,"class","column symbol embedding-d etail svelte-rng1pj")},m(c,v){W(c,e,v),I(e,t),I(e,s);for(let p=0;p<q.length;p+=1)q[p]&&q[p].m(e,null);W(c,o,v),W(c,r,v);for(let p=0;p<A.length;p+=1)A[p]&&A[p].m(r,null);W(c,h,v),W(c,i,v),I(i,a),I(i,u);for(let p=0;p<H.length;p+=1)H[p]&&H[p].m(i,null);W(c,m,v),W(c,C,v);for(let p=0;p<f.length;p+=1)f[p]&&f[p].m(C,null);N=!0},p(c,v){if(v&8){D=ce(c[3]);let p;for(p=0;p<D.length;p+=1){const k=Bl(c,D,p);q[p]?(q[p].p(k,v),X(q[p],1)):(q[p]=xl(),q[p].c(),X(q[p],1),q[p].m(e,null))}for(Be(),p=D.length;p<q.length;p+=1)O(p);ze()}if(v&8){y=ce(c[3]);let p;for(p=0;p<y.length;p+=1){const k=Ll(c,y,p);A[p]?A[p].p(k,v):(A[p]=Ol(),A[p].c(),A[p].m(r,null))}for(;p<A.length;p+=1)A[p].d(1);A.length=y.length}if(v&8){T=ce(c[3]);let p;for(p=0;p<T.length;p+=1){const k=Ml(c,T,p);H[p]?(H[p].p(k,v),X(H[p],1)):(H[p]=jl(),H[p].c(),X(H[p],1),H[p].m(i,null))}for(Be(),p=T.length;p<H.length;p+=1)P(p);ze()}if(v&8){Q=ce(c[3]);let p;for(p=0;p<Q.length;p+=1){const k=Nl(c,Q,p);f[p]?f[p].p(k,v):(f[p]=Gl(),f[p].c(),f[p].m(C,null))}for(;p<f.length;p+=1)f[p].d(1);f.length=Q.length}},i(c){if(!N){for(let v=0;v<D.length;v+=1)X(q[v]);for(let v=0;v<T.length;v+=1)X(H[v]);N=!0}},o(c){q=q.filter(Boolean);for(let v=0;v<q.length;v+=1)te(q[v]);H=H.filter(Boolean);for(let v=0;v<H.length;v+=1)te(H[v]);N=!1},d(c){c&&($(e),$(o),$(r),$(h),$(i),$(m),$(C)),De(q,c),De(A,c),De(H,c),De(f,c)}}}function xl(n){let e,t,l='<span>vocabulary</span><svg class="h-3 w-3 text-gray-600" aria-hidden="true" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke="currentColor" stroke-linecap="round" stroke-width="2" d="m21 21-3.5-3.5M17 10a7 7 0 1 1-14 0 7 7 0 0 1 14 0Z"></path></svg>',s,o,r,h,i=(Math.random()*1e4).toFixed()+"",a,d,u,m,C,N;return m=new At({}),{c(){e=M("div"),t=M("div"),t.innerHTML=l,s=G(),o=M("div"),r=M("span"),h=pe("id: "),a=pe(i),d=G(),u=M("div"),ue(m.$$.fragment),C=G(),this.h()},l(D){e=L(D,"DIV",{class:!0});var q=B(e);t=L(q,"DIV",{class:!0,"data-svelte-h":!0}),ye(t)!=="svelte-zysj00"&&(t.innerHTML=l),s=R(q),o=L(q,"DIV",{class:!0});var O=B(o);r=L(O,"SPAN",{class:!0});var y=B(r);h=ge(y,"id: "),a=ge(y,i),y.forEach($),d=R(O),u=L(O,"DIV",{class:!0});var A=B(u);fe(m.$$.fragment,A),A.forEach($),O.forEach($),C=R(q),q.forEach($),this.h()},h(){_(t,"class","vocab-index ellipsis flex items-center text-right text-xs text-gray-400 svelte-rng1pj"),_(r,"class","index-val bg-gray-100 text-center text-xs svelte-rng1pj"),_(u,"class",re(`vector ${Nt}`)+" svelte-rng1pj"),_(o,"class","flex"),_(e,"class","token-id flex items-center")},m(D,q){W(D,e,q),I(e,t),I(e,s),I(e,o),I(o,r),I(r,h),I(r,a),I(o,d),I(o,u),he(m,u,null),I(e,C),N=!0},p:qe,i(D){N||(X(m.$$.fragment,D),N=!0)},o(D){te(m.$$.fragment,D),N=!1},d(D){D&&$(e),de(m)}}}function Ol(n){let e,t="+";return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-124y0va"&&(e.textContent=t),this.h()},h(){_(e,"class","cell svelte-rng1pj")},m(l,s){W(l,e,s)},p:qe,d(l){l&&$(e)}}}function jl(n){let e,t,l,s,o;return l=new At({}),{c(){e=M("div"),t=M("div"),ue(l.$$.fragment),s=G(),this.h()},l(r){e=L(r,"DIV",{class:!0});var h=B(e);t=L(h,"DIV",{class:!0});var i=B(t);fe(l.$$.fragment,i),i.forEach($),s=R(h),h.forEach($),this.h()},h(){_(t,"class",re(`vector ${Nt}`)+" svelte-rng1pj"),_(e,"class","cell flex items-center svelte-rng1pj")},m(r,h){W(r,e,h),I(e,t),he(l,t,null),I(e,s),o=!0},p:qe,i(r){o||(X(l.$$.fragment,r),o=!0)},o(r){te(l.$$.fragment,r),o=!1},d(r){r&&$(e),de(l)}}}function Gl(n){let e,t="=";return{c(){e=M("div"),e.textContent=t,this.h()},l(l){e=L(l,"DIV",{class:!0,"data-svelte-h":!0}),ye(e)!=="svelte-1btrmmo"&&(e.textContent=t),this.h()},h(){_(e,"class","cell svelte-rng1pj")},m(l,s){W(l,e,s)},p:qe,d(l){l&&$(e)}}}function Rl(n){var o,r;let e,t,l,s;return t=new At({props:{data:(r=(o=n[4])==null?void 0:o.outputs.input_emb)==null?void 0:r.data[n[21]],active:n[2]||n[1]}}),{c(){e=M("div"),ue(t.$$.fragment),l=G(),this.h()},l(h){e=L(h,"DIV",{class:!0});var i=B(e);fe(t.$$.fragment,i),l=R(i),i.forEach($),this.h()},h(){_(e,"class",re(`vector ${Nt}`)+" svelte-rng1pj"),ne(e,"last",n[21]===n[3].length-1)},m(h,i){W(h,e,i),he(t,e,null),I(e,l),s=!0},p(h,i){var d,u;const a={};i&16&&(a.data=(u=(d=h[4])==null?void 0:d.outputs.input_emb)==null?void 0:u.data[h[21]]),i&6&&(a.active=h[2]||h[1]),t.$set(a),(!s||i&8)&&ne(e,"last",h[21]===h[3].length-1)},i(h){s||(X(t.$$.fragment,h),s=!0)},o(h){te(t.$$.fragment,h),s=!1},d(h){h&&$(e),de(t)}}}function po(n){let e,t,l="<div>Embedding</div>",s,o,r,h,i,a,d,u,m,C,N,D,q,O,y,A,T,H,P,Q,f,c=n[1]&&Tl(),v=ce(n[3]),p=[];for(let g=0;g<v.length;g+=1)p[g]=Hl(zl(n,v,g));let k=n[1]&&Pl(n),V=ce(n[3]),E=[];for(let g=0;g<V.length;g+=1)E[g]=Rl(Al(n,V,g));const b=g=>te(E[g],1,1,()=>{E[g]=null});return q=new Fe({props:{type:"dropout",id:"embedding-dropout"}}),y=new Fe({props:{type:"residual-start",id:"residual-first"}}),T=new Fe({props:{type:"ln",id:"embedding-ln"}}),{c(){e=M("div"),t=M("div"),t.innerHTML=l,s=G(),o=M("div"),r=M("div"),h=M("div"),c&&c.c(),i=G();for(let g=0;g<p.length;g+=1)p[g].c();a=G(),d=M("div"),u=G(),k&&k.c(),m=G(),C=M("div"),N=M("div");for(let g=0;g<E.length;g+=1)E[g].c();D=G(),ue(q.$$.fragment),O=G(),ue(y.$$.fragment),A=G(),ue(T.$$.fragment),this.h()},l(g){e=L(g,"DIV",{class:!0,role:!0,tabindex:!0});var S=B(e);t=L(S,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),ye(t)!=="svelte-gfbk07"&&(t.innerHTML=l),s=R(S),o=L(S,"DIV",{class:!0});var w=B(o);r=L(w,"DIV",{class:!0,role:!0,tabindex:!0});var z=B(r);h=L(z,"DIV",{class:!0});var U=B(h);c&&c.l(U),i=R(U);for(let se=0;se<p.length;se+=1)p[se].l(U);a=R(U),d=L(U,"DIV",{class:!0}),B(d).forEach($),U.forEach($),u=R(z),k&&k.l(z),z.forEach($),m=R(w),C=L(w,"DIV",{class:!0});var Z=B(C);N=L(Z,"DIV",{class:!0,role:!0,tabindex:!0});var ee=B(N);for(let se=0;se<E.length;se+=1)E[se].l(ee);ee.forEach($),D=R(Z),fe(q.$$.fragment,Z),O=R(Z),fe(y.$$.fragment,Z),A=R(Z),fe(T.$$.fragment,Z),Z.forEach($),w.forEach($),S.forEach($),this.h()},h(){_(t,"class","title expandable svelte-rng1pj"),_(t,"role","group"),_(d,"class","bounding embedding-bounding svelte-rng1pj"),ne(d,"active",n[2]&&!n[1]),_(h,"class","column token-string relative svelte-rng1pj"),_(r,"class","token-column resizable resize-watch flex"),_(r,"role","button"),_(r,"tabindex","0"),_(N,"class","column vectors svelte-rng1pj"),_(N,"role","button"),_(N,"tabindex","0"),_(C,"class","vector-column flex"),_(o,"class","content relative svelte-rng1pj"),_(e,"class",H=re(oe("embedding",n[0]))+" svelte-rng1pj"),_(e,"role","button"),_(e,"tabindex","0")},m(g,S){W(g,e,S),I(e,t),I(e,s),I(e,o),I(o,r),I(r,h),c&&c.m(h,null),I(h,i);for(let w=0;w<p.length;w+=1)p[w]&&p[w].m(h,null);I(h,a),I(h,d),I(r,u),k&&k.m(r,null),I(o,m),I(o,C),I(C,N);for(let w=0;w<E.length;w+=1)E[w]&&E[w].m(N,null);I(C,D),he(q,C,null),I(C,O),he(y,C,null),I(C,A),he(T,C,null),P=!0,Q||(f=[_e(t,"mouseenter",n[6]),_e(t,"mouseleave",n[7]),_e(r,"mouseenter",n[6]),_e(r,"mouseleave",n[7]),_e(r,"click",n[5]),_e(r,"keydown",n[5]),_e(N,"mouseenter",n[6]),_e(N,"mouseleave",n[7]),_e(N,"click",n[5]),_e(N,"keydown",n[5]),_e(e,"click",n[5]),_e(e,"keydown",n[5])],Q=!0)},p(g,[S]){if(g[1]?c||(c=Tl(),c.c(),c.m(h,i)):c&&(c.d(1),c=null),S&8){v=ce(g[3]);let w;for(w=0;w<v.length;w+=1){const z=zl(g,v,w);p[w]?p[w].p(z,S):(p[w]=Hl(z),p[w].c(),p[w].m(h,a))}for(;w<p.length;w+=1)p[w].d(1);p.length=v.length}if((!P||S&6)&&ne(d,"active",g[2]&&!g[1]),g[1]?k?(k.p(g,S),S&2&&X(k,1)):(k=Pl(g),k.c(),X(k,1),k.m(r,null)):k&&(Be(),te(k,1,1,()=>{k=null}),ze()),S&30){V=ce(g[3]);let w;for(w=0;w<V.length;w+=1){const z=Al(g,V,w);E[w]?(E[w].p(z,S),X(E[w],1)):(E[w]=Rl(z),E[w].c(),X(E[w],1),E[w].m(N,null))}for(Be(),w=V.length;w<E.length;w+=1)b(w);ze()}(!P||S&1&&H!==(H=re(oe("embedding",g[0]))+" svelte-rng1pj"))&&_(e,"class",H)},i(g){if(!P){X(k);for(let S=0;S<V.length;S+=1)X(E[S]);X(q.$$.fragment,g),X(y.$$.fragment,g),X(T.$$.fragment,g),P=!0}},o(g){te(k),E=E.filter(Boolean);for(let S=0;S<E.length;S+=1)te(E[S]);te(q.$$.fragment,g),te(y.$$.fragment,g),te(T.$$.fragment,g),P=!1},d(g){g&&$(e),c&&c.d(),De(p,g),k&&k.d(),De(E,g),de(q),de(y),de(T),Q=!1,Pe(f)}}}const Nt="bg-gray-300";function go(n,e,t){let l,s,o;be(n,Re,q=>t(8,l=q)),be(n,Ze,q=>t(3,s=q)),be(n,ut,q=>t(4,o=q));let{className:r=void 0}=e;bt("block-id","embedding");const h=_t("block-id");let i=!1;const a=()=>{i?(Re.set({id:null}),m()):(Re.set({id:h}),u())};let d;const u=async()=>{d=tt.Flip.getState(".embedding .token-column"),t(1,i=!0),await st(),tt.Flip.from(d,{duration:1,ease:"power2.inOut"}),ot.to(".embedding-detail",{opacity:1,duration:.5,delay:.5})},m=async()=>{d=tt.Flip.getState(".embedding .token-column"),t(1,i=!1),await st(),tt.Flip.from(d,{duration:.5,ease:"power2.inOut"})};let C=!1;function N(){t(2,C=!0)}function D(){t(2,C=!1)}return n.$$set=q=>{"className"in q&&t(0,r=q.className)},n.$$.update=()=>{n.$$.dirty&258&&l.id!==h&&i&&(t(1,i=!1),m())},[r,i,C,s,o,a,N,D,l]}class mo extends Me{constructor(e){super(),Le(this,e,go,po,Ne,{className:0})}}function Fl(n,e,t){const l=n.slice();return l[6]=e[t],l[8]=t,l}function Ul(n,e,t){const l=n.slice();return l[6]=e[t],l[8]=t,l}function Wl(n,e,t){const l=n.slice();return l[6]=e[t],l[8]=t,l}function Xl(n){let e,t,l=n[6]+"",s,o,r,h,i,a,d;return{c(){e=M("div"),t=M("span"),s=pe(l),o=G(),r=M("div"),h=M("div"),i=G(),a=M("div"),d=G(),this.h()},l(u){e=L(u,"DIV",{class:!0});var m=B(e);t=L(m,"SPAN",{class:!0});var C=B(t);s=ge(C,l),C.forEach($),o=R(m),r=L(m,"DIV",{class:!0});var N=B(r);h=L(N,"DIV",{class:!0}),B(h).forEach($),i=R(N),a=L(N,"DIV",{class:!0}),B(a).forEach($),N.forEach($),d=R(m),m.forEach($),this.h()},h(){_(t,"class","label float"),_(h,"class","sub-vector x1-12 head1"),_(a,"class","sub-vector head-rest grow"),_(r,"class",re(`vector flex flex-col  ${_o}`)+" svelte-r5b4c7"),_(e,"class","cell"),ne(e,"last",n[8]===n[3].length-1)},m(u,m){W(u,e,m),I(e,t),I(t,s),I(e,o),I(e,r),I(r,h),I(r,i),I(r,a),I(e,d)},p(u,m){m&8&&l!==(l=u[6]+"")&&Se(s,l),m&8&&ne(e,"last",u[8]===u[3].length-1)},d(u){u&&$(e)}}}function Zl(n){let e,t,l,s;return{c(){e=M("div"),t=M("div"),l=G(),this.h()},l(o){e=L(o,"DIV",{class:!0});var r=B(e);t=L(r,"DIV",{class:!0}),B(t).forEach($),l=R(r),r.forEach($),this.h()},h(){_(t,"class",re(oe(`vector x4 ${bo} opacity-60`))+" svelte-r5b4c7"),_(e,"class",s=re(oe("cell x4",{small:n[8]!==0&&n[8]!==n[3].length-1}))+" svelte-r5b4c7"),ne(e,"last",n[8]===n[3].length-1)},m(o,r){W(o,e,r),I(e,t),I(e,l)},p(o,r){r&8&&s!==(s=re(oe("cell x4",{small:o[8]!==0&&o[8]!==o[3].length-1}))+" svelte-r5b4c7")&&_(e,"class",s),r&8&&ne(e,"last",o[8]===o[3].length-1)},d(o){o&&$(e)}}}function Yl(n){let e,t,l;return{c(){e=M("div"),t=M("div"),l=G(),this.h()},l(s){e=L(s,"DIV",{class:!0});var o=B(e);t=L(o,"DIV",{class:!0}),B(t).forEach($),l=R(o),o.forEach($),this.h()},h(){_(t,"class",re(`vector ${ko}`)+" svelte-r5b4c7"),_(e,"class","cell"),ne(e,"last",n[8]===n[3].length-1)},m(s,o){W(s,e,o),I(e,t),I(e,l)},p(s,o){o&8&&ne(e,"last",s[8]===s[3].length-1)},d(s){s&&$(e)}}}function vo(n){let e,t,l="MLP",s,o,r,h,i,a,d,u,m,C,N,D,q,O,y,A,T,H,P,Q,f,c,v,p,k,V,E,b,g,S,w,z,U,Z=ce(n[3]),ee=[];for(let j=0;j<Z.length;j+=1)ee[j]=Xl(Wl(n,Z,j));C=new Fe({props:{type:"dropout",id:"mlp-first-dropout"}}),D=new Fe({props:{type:"residual-end",id:"residual-first"}}),O=new Fe({props:{type:"ln",id:"mlp-first-ln"}}),A=new Fe({props:{type:"residual-start",id:"residual-second"}});let se=ce(n[3]),F=[];for(let j=0;j<se.length;j+=1)F[j]=Zl(Ul(n,se,j));c=new Fe({props:{type:"activation",id:"mlp-activation",className:"x4"}}),k=new Fe({props:{type:"residual-end",id:"residual-second"}}),E=new Fe({props:{type:"ln",id:"mlp-second-ln"}});let x=ce(n[3]),J=[];for(let j=0;j<x.length;j+=1)J[j]=Yl(Fl(n,x,j));return{c(){e=M("div"),t=M("div"),t.textContent=l,s=G(),o=M("div"),r=M("div"),h=G(),i=M("div"),a=G(),d=M("div"),u=M("div");for(let j=0;j<ee.length;j+=1)ee[j].c();m=G(),ue(C.$$.fragment),N=G(),ue(D.$$.fragment),q=G(),ue(O.$$.fragment),y=G(),ue(A.$$.fragment),T=G(),H=M("div"),P=M("div"),Q=M("div");for(let j=0;j<F.length;j+=1)F[j].c();f=G(),ue(c.$$.fragment),v=G(),p=M("div"),ue(k.$$.fragment),V=G(),ue(E.$$.fragment),b=G(),g=M("div");for(let j=0;j<J.length;j+=1)J[j].c();this.h()},l(j){e=L(j,"DIV",{class:!0});var K=B(e);t=L(K,"DIV",{class:!0,role:!0,"data-svelte-h":!0}),ye(t)!=="svelte-50ab67"&&(t.textContent=l),s=R(K),o=L(K,"DIV",{class:!0});var Y=B(o);r=L(Y,"DIV",{class:!0}),B(r).forEach($),h=R(Y),i=L(Y,"DIV",{class:!0}),B(i).forEach($),a=R(Y),d=L(Y,"DIV",{class:!0});var ve=B(d);u=L(ve,"DIV",{class:!0});var ke=B(u);for(let Te=0;Te<ee.length;Te+=1)ee[Te].l(ke);ke.forEach($),m=R(ve),fe(C.$$.fragment,ve),N=R(ve),fe(D.$$.fragment,ve),q=R(ve),fe(O.$$.fragment,ve),y=R(ve),fe(A.$$.fragment,ve),ve.forEach($),T=R(Y),H=L(Y,"DIV",{class:!0});var Ve=B(H);P=L(Ve,"DIV",{class:!0});var Ee=B(P);Q=L(Ee,"DIV",{class:!0});var Ie=B(Q);for(let Te=0;Te<F.length;Te+=1)F[Te].l(Ie);Ie.forEach($),f=R(Ee),fe(c.$$.fragment,Ee),Ee.forEach($),v=R(Ve),p=L(Ve,"DIV",{class:!0});var ae=B(p);fe(k.$$.fragment,ae),V=R(ae),fe(E.$$.fragment,ae),b=R(ae),g=L(ae,"DIV",{class:!0});var ft=B(g);for(let Te=0;Te<J.length;Te+=1)J[Te].l(ft);ft.forEach($),ae.forEach($),Ve.forEach($),Y.forEach($),K.forEach($),this.h()},h(){_(t,"class","title"),_(t,"role","group"),_(r,"class","bounding transformer-bounding svelte-r5b4c7"),ne(r,"active",n[2]),_(i,"class","bounding mlp-bounding svelte-r5b4c7"),ne(i,"active",n[1]),_(u,"class","column initial"),_(d,"class","layer first-layer flex svelte-r5b4c7"),_(Q,"class","column"),_(P,"class","projections flex"),_(g,"class","column out"),_(p,"class","ouputs flex"),_(H,"class","layer second-layer flex justify-between svelte-r5b4c7"),_(o,"class","content relative svelte-r5b4c7"),_(e,"class",S=re(oe("mlp",n[0]))+" svelte-r5b4c7")},m(j,K){W(j,e,K),I(e,t),I(e,s),I(e,o),I(o,r),I(o,h),I(o,i),I(o,a),I(o,d),I(d,u);for(let Y=0;Y<ee.length;Y+=1)ee[Y]&&ee[Y].m(u,null);I(d,m),he(C,d,null),I(d,N),he(D,d,null),I(d,q),he(O,d,null),I(d,y),he(A,d,null),I(o,T),I(o,H),I(H,P),I(P,Q);for(let Y=0;Y<F.length;Y+=1)F[Y]&&F[Y].m(Q,null);I(P,f),he(c,P,null),I(H,v),I(H,p),he(k,p,null),I(p,V),he(E,p,null),I(p,b),I(p,g);for(let Y=0;Y<J.length;Y+=1)J[Y]&&J[Y].m(g,null);w=!0,z||(U=[_e(t,"mouseenter",n[4]),_e(t,"mouseleave",n[5])],z=!0)},p(j,[K]){if((!w||K&4)&&ne(r,"active",j[2]),(!w||K&2)&&ne(i,"active",j[1]),K&8){Z=ce(j[3]);let Y;for(Y=0;Y<Z.length;Y+=1){const ve=Wl(j,Z,Y);ee[Y]?ee[Y].p(ve,K):(ee[Y]=Xl(ve),ee[Y].c(),ee[Y].m(u,null))}for(;Y<ee.length;Y+=1)ee[Y].d(1);ee.length=Z.length}if(K&8){se=ce(j[3]);let Y;for(Y=0;Y<se.length;Y+=1){const ve=Ul(j,se,Y);F[Y]?F[Y].p(ve,K):(F[Y]=Zl(ve),F[Y].c(),F[Y].m(Q,null))}for(;Y<F.length;Y+=1)F[Y].d(1);F.length=se.length}if(K&8){x=ce(j[3]);let Y;for(Y=0;Y<x.length;Y+=1){const ve=Fl(j,x,Y);J[Y]?J[Y].p(ve,K):(J[Y]=Yl(ve),J[Y].c(),J[Y].m(g,null))}for(;Y<J.length;Y+=1)J[Y].d(1);J.length=x.length}(!w||K&1&&S!==(S=re(oe("mlp",j[0]))+" svelte-r5b4c7"))&&_(e,"class",S)},i(j){w||(X(C.$$.fragment,j),X(D.$$.fragment,j),X(O.$$.fragment,j),X(A.$$.fragment,j),X(c.$$.fragment,j),X(k.$$.fragment,j),X(E.$$.fragment,j),w=!0)},o(j){te(C.$$.fragment,j),te(D.$$.fragment,j),te(O.$$.fragment,j),te(A.$$.fragment,j),te(c.$$.fragment,j),te(k.$$.fragment,j),te(E.$$.fragment,j),w=!1},d(j){j&&$(e),De(ee,j),de(C),de(D),de(O),de(A),De(F,j),de(c),de(k),de(E),De(J,j),z=!1,Pe(U)}}}const _o="bg-purple-200",bo="bg-indigo-200",ko="bg-blue-200";function wo(n,e,t){let l,s;be(n,ht,a=>t(2,l=a)),be(n,Ze,a=>t(3,s=a));let{className:o=void 0}=e;bt("block-id","mlp");let r=!1;function h(){t(1,r=!0)}function i(){t(1,r=!1)}return n.$$set=a=>{"className"in a&&t(0,o=a.className)},[o,r,l,s,h,i]}class $o extends Me{constructor(e){super(),Le(this,e,wo,vo,Ne,{className:0})}}async function yo(n){const e=await fetch(n);if(!e.ok)throw new Error(`Failed to fetch ${n}`);return e.arrayBuffer()}async function Eo(n){const e=await Promise.all(n.map(o=>yo(o))),t=e.reduce((o,r)=>o+r.byteLength,0),l=new Uint8Array(t);let s=0;for(const o of e)l.set(new Uint8Array(o),s),s+=o.byteLength;return l.buffer}function Io(n){let e,t,l,s,o,r,h,i,a,d,u,m,C,N,D,q,O,y,A,T,H;return l=new jn({}),h=new mo({props:{className:"step"}}),a=new vs({props:{className:"step"}}),u=new $o({props:{className:"step"}}),C=new Cs({props:{className:"step"}}),D=new Ts({props:{className:"step"}}),{c(){e=M("div"),t=M("div"),ue(l.$$.fragment),s=G(),o=M("div"),r=M("div"),ue(h.$$.fragment),i=G(),ue(a.$$.fragment),d=G(),ue(u.$$.fragment),m=G(),ue(C.$$.fragment),N=G(),ue(D.$$.fragment),O=G(),y=M("div"),this.h()},l(P){e=L(P,"DIV",{class:!0,style:!0});var Q=B(e);t=L(Q,"DIV",{class:!0});var f=B(t);fe(l.$$.fragment,f),f.forEach($),s=R(Q),o=L(Q,"DIV",{class:!0});var c=B(o);r=L(c,"DIV",{class:!0});var v=B(r);fe(h.$$.fragment,v),i=R(v),fe(a.$$.fragment,v),d=R(v),fe(u.$$.fragment,v),m=R(v),fe(C.$$.fragment,v),N=R(v),fe(D.$$.fragment,v),v.forEach($),c.forEach($),O=R(Q),y=L(Q,"DIV",{class:!0}),B(y).forEach($),Q.forEach($),this.h()},h(){_(t,"class","sankey opacity-1 svelte-184lj4x"),_(r,"class","steps svelte-184lj4x"),tn(()=>n[6].call(r)),ne(r,"expanded",n[2]),_(o,"class","nodes resize-watch svelte-184lj4x"),_(y,"class",A=re(oe("dim pointer-events-none",`${n[1].id||""}`,{active:!!n[1].id}))+" svelte-184lj4x"),_(e,"class","main-section h-full"),_(e,"style",T=`--vector-height: ${n[3]}px;--title-height: ${n[4]}px;`)},m(P,Q){W(P,e,Q),I(e,t),he(l,t,null),I(e,s),I(e,o),I(o,r),he(h,r,null),I(r,i),he(a,r,null),I(r,d),he(u,r,null),I(r,m),he(C,r,null),I(r,N),he(D,r,null),q=ln(r,n[6].bind(r)),I(e,O),I(e,y),H=!0},p(P,[Q]){(!H||Q&4)&&ne(r,"expanded",P[2]),(!H||Q&2&&A!==(A=re(oe("dim pointer-events-none",`${P[1].id||""}`,{active:!!P[1].id}))+" svelte-184lj4x"))&&_(y,"class",A),(!H||Q&8&&T!==(T=`--vector-height: ${P[3]}px;--title-height: ${P[4]}px;`))&&_(e,"style",T)},i(P){H||(X(l.$$.fragment,P),X(h.$$.fragment,P),X(a.$$.fragment,P),X(u.$$.fragment,P),X(C.$$.fragment,P),X(D.$$.fragment,P),H=!0)},o(P){te(l.$$.fragment,P),te(h.$$.fragment,P),te(a.$$.fragment,P),te(u.$$.fragment,P),te(C.$$.fragment,P),te(D.$$.fragment,P),H=!1},d(P){P&&$(e),de(l),de(h),de(a),de(u),de(C),de(D),q()}}}function Do(n,e,t){let l,s,o,r,h;be(n,Ze,C=>t(5,l=C)),be(n,ut,C=>t(7,s=C)),be(n,St,C=>t(8,o=C)),be(n,Re,C=>t(1,r=C)),be(n,Vt,C=>t(3,h=C));let i=!1;dt(async()=>{const N=Array(4).fill(0).map((P,Q)=>`${Mn}/gpt2-quant.onnx.part${Q}.gz`),D=await Eo(N),q=new Blob([D],{type:"application/octet-stream"}),O=URL.createObjectURL(q),y=await kn.create(O,{});sn.set(y);const A=wn.subscribe(P=>{Os(P,o)});let T=!0;const H=St.subscribe(P=>{if(T){T=!1;return}js(s==null?void 0:s.prediction,P)});return()=>{A(),H()}});let a=0,d=ct*5;const u=()=>{const C=ct*.5*(l.length-1),N=Math.min(Math.max((a-d-C)/l.length/$n,yn),En);Vt.set(N),nn.set(l.length*N*3+C)};function m(){a=this.offsetHeight,t(0,a)}return n.$$.update=()=>{n.$$.dirty&2&&(r.id!==null?t(2,i=!0):t(2,i=!1)),n.$$.dirty&33&&(a||l.length)&&u()},[a,r,i,h,d,l,m]}class To extends Me{constructor(e){super(),Le(this,e,Do,Io,Ne,{})}}export{To as component,zo as universal};
